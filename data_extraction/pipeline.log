2025-08-23 23:00:14,445 - __main__ - INFO - Prometheus HTTP server started.
2025-08-23 23:00:14,675 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-23 23:00:22,351 - __main__ - INFO - Starting SQS consumer...
2025-08-23 23:00:42,871 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:00:42,872 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:00:49,850 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:11:32,612 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/ with status: Success
2025-08-23 23:11:33,540 - __main__ - INFO - Successfully scraped and validated data for https://www.apartments.com/longwood-row-boston-ma/kp71r5c/.
2025-08-23 23:11:33,646 - root - INFO - Starting to save 1 properties to the database...
2025-08-23 23:11:52,125 - root - INFO - Updating existing property: Longwood Row
2025-08-23 23:11:54,024 - root - INFO - Successfully processed and committed property: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:11:59,202 - __main__ - INFO - Successfully deleted message for https://www.apartments.com/longwood-row-boston-ma/kp71r5c/ from queue.
2025-08-23 23:12:29,801 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/proto-kendall-square-cambridge-ma/wvwfs4l/
2025-08-23 23:12:29,852 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/proto-kendall-square-cambridge-ma/wvwfs4l/
2025-08-23 23:12:39,659 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/proto-kendall-square-cambridge-ma/wvwfs4l/
2025-08-23 23:26:19,186 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed\nCall log:\n  - waiting for locator("li.unitContainer").nth(12).locator(".rentLabel")\n')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
Call log:
  - waiting for locator("li.unitContainer").nth(12).locator(".rentLabel")

2025-08-24 12:22:54,568 - __main__ - INFO - Starting the producer orchestration.
2025-08-24 12:22:54,719 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 12:23:02,694 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-24 12:24:40,808 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-24 12:24:56,001 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-24 12:24:56,006 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-24 12:25:39,203 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:25:46,001 - data_extraction.scraper - INFO - Scraping page 2...
2025-08-24 12:26:05,357 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:06,867 - data_extraction.scraper - INFO - Scraping page 3...
2025-08-24 12:26:16,367 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:17,767 - data_extraction.scraper - INFO - Scraping page 4...
2025-08-24 12:26:24,881 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:26,273 - data_extraction.scraper - INFO - Scraping page 5...
2025-08-24 12:26:33,595 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:34,971 - data_extraction.scraper - INFO - Scraping page 6...
2025-08-24 12:26:42,469 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:44,132 - data_extraction.scraper - INFO - Scraping page 7...
2025-08-24 12:26:50,804 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:52,255 - data_extraction.scraper - INFO - Scraping page 8...
2025-08-24 12:27:00,022 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:01,434 - data_extraction.scraper - INFO - Scraping page 9...
2025-08-24 12:27:09,146 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:10,728 - data_extraction.scraper - INFO - Scraping page 10...
2025-08-24 12:27:17,617 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:18,961 - data_extraction.scraper - INFO - Scraping page 11...
2025-08-24 12:27:21,783 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:23,109 - data_extraction.scraper - INFO - Scraping page 12...
2025-08-24 12:27:25,731 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:27,139 - data_extraction.scraper - INFO - Scraping page 13...
2025-08-24 12:27:30,221 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:31,605 - data_extraction.scraper - INFO - Scraping page 14...
2025-08-24 12:27:34,386 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:35,835 - data_extraction.scraper - INFO - Scraping page 15...
2025-08-24 12:27:38,185 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:39,562 - data_extraction.scraper - INFO - Scraping page 16...
2025-08-24 12:27:42,514 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:43,934 - data_extraction.scraper - INFO - Scraping page 17...
2025-08-24 12:27:46,525 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:47,989 - data_extraction.scraper - INFO - Scraping page 18...
2025-08-24 12:27:49,815 - data_extraction.scraper - INFO - No more pages found. Ending pagination.
2025-08-24 12:27:49,994 - data_extraction.scraper - INFO - Scraping complete. Extracted 699 unique property URLs.
2025-08-24 12:27:49,995 - __main__ - INFO - Found 699 properties. Sending 10 URLs to SQS.
2025-08-24 12:27:51,390 - __main__ - INFO - All messages sent to SQS.
2025-08-24 12:27:53,980 - __main__ - INFO - Producer process completed.
2025-08-24 12:29:13,912 - __main__ - INFO - Prometheus HTTP server started.
2025-08-24 12:29:13,939 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 12:29:15,803 - __main__ - INFO - Starting SQS consumer...
2025-08-24 12:29:44,898 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:29:44,900 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:29:56,233 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:42:12,962 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ with status: Success
2025-08-24 12:42:13,229 - __main__ - INFO - Successfully scraped and validated data for https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/.
2025-08-24 12:42:13,230 - root - INFO - Starting to save 1 properties to the database...
2025-08-24 12:42:19,703 - root - INFO - Inserting new property: Axiom Apartments
2025-08-24 12:42:20,870 - root - INFO - Successfully processed and committed property: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:42:21,895 - __main__ - INFO - Successfully deleted message for https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ from queue.
2025-08-24 12:42:35,638 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/
2025-08-24 12:42:35,640 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/
2025-08-24 12:42:43,665 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/
2025-08-24 12:42:44,370 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-24 12:42:44,370 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/ with status: Failed: Critical Data Missing
2025-08-24 12:42:44,396 - __main__ - ERROR - Validation failed for URL: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/. Error: Failed: Critical Data Missing
2025-08-24 12:42:55,413 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/
2025-08-24 12:42:55,414 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/
2025-08-24 12:43:00,497 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/
2025-08-24 12:43:01,305 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-24 12:43:01,306 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/ with status: Failed: Critical Data Missing
2025-08-24 12:43:01,367 - __main__ - ERROR - Validation failed for URL: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/. Error: Failed: Critical Data Missing
2025-08-24 12:43:10,896 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/
2025-08-24 12:43:10,896 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/
2025-08-24 12:43:15,199 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/
2025-08-24 12:43:16,279 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-24 12:43:16,279 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/ with status: Failed: Critical Data Missing
2025-08-24 12:43:16,296 - __main__ - ERROR - Validation failed for URL: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/. Error: Failed: Critical Data Missing
2025-08-24 12:43:27,779 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/
2025-08-24 12:43:27,780 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/
2025-08-24 12:43:33,073 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/
2025-08-24 12:56:32,944 - __main__ - INFO - Prometheus HTTP server started.
2025-08-24 12:56:32,974 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 12:56:40,838 - __main__ - INFO - Starting SQS consumer...
2025-08-24 13:08:21,765 - __main__ - CRITICAL - Critical error processing URL https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/: Browser.close: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 52, in process_message
    async with ApartmentScraper(p) as scraper:
               ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 49, in __aexit__
    await self.browser.close()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 14223, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 195, in close
    raise e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 192, in close
    await self._channel.send("close", {"reason": reason})
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver
2025-08-24 13:31:21,548 - __main__ - INFO - Prometheus HTTP server started.
2025-08-24 13:31:21,651 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 13:31:37,552 - __main__ - INFO - Starting SQS consumer...
2025-08-24 13:31:43,216 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:48:53,544 - __main__ - INFO - Prometheus HTTP server started.
2025-08-25 11:48:53,650 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 11:48:59,164 - __main__ - INFO - Starting SQS consumer...
2025-08-25 11:49:00,849 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:11,121 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:21,397 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:31,681 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:42,056 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:52,399 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:02,711 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:13,083 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:23,363 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:33,662 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:43,944 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:54,248 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:51:04,588 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:58:29,456 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-25 11:58:41,827 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 11:58:44,442 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-25 11:58:44,454 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-25 11:58:48,142 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 11:58:48,143 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 11:58:53,041 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 12:21:16,536 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-25 12:21:17,123 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 103, in scrape_single_property_page
    try:
    
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-25 12:21:17,273 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/ reason=Failed: Exception
2025-08-25 12:21:17,304 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-25 12:21:17,636 - __main__ - INFO - Consumer process exited.
2025-08-25 12:22:01,609 - __main__ - INFO - Starting the producer orchestration.
2025-08-25 12:22:01,628 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 12:22:05,142 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-25 12:22:23,652 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-25 12:22:28,729 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-25 12:22:28,730 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-25 12:22:41,276 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:22:45,353 - data_extraction.scraper - INFO - Scraping page 2...
2025-08-25 12:22:55,726 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:22:57,338 - data_extraction.scraper - INFO - Scraping page 3...
2025-08-25 12:23:04,933 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:06,278 - data_extraction.scraper - INFO - Scraping page 4...
2025-08-25 12:23:11,645 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:12,989 - data_extraction.scraper - INFO - Scraping page 5...
2025-08-25 12:23:17,295 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:18,546 - data_extraction.scraper - INFO - Scraping page 6...
2025-08-25 12:23:23,034 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:25,293 - data_extraction.scraper - INFO - Scraping page 7...
2025-08-25 12:23:34,971 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:38,096 - data_extraction.scraper - INFO - Scraping page 8...
2025-08-25 12:23:43,873 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:45,329 - data_extraction.scraper - INFO - Scraping page 9...
2025-08-25 12:23:48,715 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:50,155 - data_extraction.scraper - INFO - Scraping page 10...
2025-08-25 12:23:55,513 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:56,736 - data_extraction.scraper - INFO - Scraping page 11...
2025-08-25 12:23:59,826 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:01,257 - data_extraction.scraper - INFO - Scraping page 12...
2025-08-25 12:24:03,956 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:05,295 - data_extraction.scraper - INFO - Scraping page 13...
2025-08-25 12:24:08,260 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:10,058 - data_extraction.scraper - INFO - Scraping page 14...
2025-08-25 12:24:15,861 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:17,668 - data_extraction.scraper - INFO - Scraping page 15...
2025-08-25 12:24:21,995 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:25,978 - data_extraction.scraper - INFO - Scraping page 16...
2025-08-25 12:24:32,001 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:33,540 - data_extraction.scraper - INFO - Scraping page 17...
2025-08-25 12:24:41,872 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:43,360 - data_extraction.scraper - INFO - Scraping page 18...
2025-08-25 12:24:45,871 - data_extraction.scraper - INFO - No more pages found. Ending pagination.
2025-08-25 12:24:46,814 - data_extraction.scraper - INFO - Scraping complete. Extracted 700 unique property URLs.
2025-08-25 12:24:46,815 - __main__ - INFO - Found 700 properties. Sending 10 URLs to SQS.
2025-08-25 12:24:48,149 - __main__ - INFO - All messages sent to SQS.
2025-08-25 12:24:55,232 - __main__ - INFO - Producer process completed.
2025-08-25 12:37:38,741 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-25 12:37:54,353 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 12:38:01,224 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-25 12:38:01,237 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-25 12:38:08,720 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 12:38:08,721 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 12:38:09,457 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 12:38:09,457 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 12:38:23,395 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 12:38:23,509 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 13:01:06,626 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/ with status: Success
2025-08-25 13:01:07,650 - __main__ - INFO - Scrape OK: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/ — persisting to DB
2025-08-25 13:01:07,671 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:01:21,652 - root - INFO - Updating existing property: 1410 Columbia
2025-08-25 13:01:25,705 - root - INFO - Successfully processed and committed property: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 13:01:25,706 - __main__ - INFO - Persisted.
2025-08-25 13:01:28,673 - __main__ - INFO - Deleted message for https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 13:05:13,257 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/ with status: Success
2025-08-25 13:05:13,413 - __main__ - INFO - Scrape OK: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/ — persisting to DB
2025-08-25 13:05:13,413 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:05:14,045 - root - INFO - Inserting new property: One Canal Apartments
2025-08-25 13:05:15,377 - root - INFO - Successfully processed and committed property: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 13:05:15,378 - __main__ - INFO - Persisted.
2025-08-25 13:05:16,494 - __main__ - INFO - Deleted message for https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 13:05:20,367 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:05:20,382 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:05:23,656 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:36:51,687 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/ with status: Success
2025-08-25 13:36:53,061 - __main__ - INFO - Scrape OK: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/ — persisting to DB
2025-08-25 13:36:53,128 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:36:55,122 - root - INFO - Updating existing property: Cambridge Ivy Inn
2025-08-25 13:36:56,278 - root - ERROR - Integrity Error for https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "property_reviews" of relation "property" violates not-null constraint
DETAIL:  Failing row contains (101, Cambridge Ivy Inn, https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cv..., Cambridge, MA, 02138, N/A, null, null, 1900, N/A, Cambridge, MA, 02138, Success, Apartment, ["3, 4, 5, 6, 7, 8, 9, 10, 11, 12", "Short term lease"], 2025-08-25 10:36:53.46837).
[SQL: UPDATE property SET address=$1::VARCHAR, property_reviews=$2::FLOAT, street=$3::VARCHAR, city=$4::VARCHAR, lease_option=$5::VARCHAR, timestamp=$6::TIMESTAMP WITHOUT TIME ZONE WHERE property.id = $7::INTEGER]
[parameters: ('Cambridge, MA, 02138', None, 'N/A', 'Cambridge', '["3, 4, 5, 6, 7, 8, 9, 10, 11, 12", "Short term lease"]', datetime.datetime(2025, 8, 25, 10, 36, 53, 468370), 101)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-25 13:36:56,282 - __main__ - INFO - Persisted.
2025-08-25 13:36:58,468 - __main__ - INFO - Deleted message for https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:37:10,679 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:37:10,738 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:37:10,782 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 13:37:10,783 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 13:37:10,787 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 13:37:10,787 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 13:37:21,850 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:37:22,284 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 13:37:22,322 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 13:37:23,096 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 13:37:23,346 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ with status: Failed: Critical Data Missing
2025-08-25 13:37:23,389 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ reason=Failed: Critical Data Missing
2025-08-25 13:50:15,580 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ with status: Success
2025-08-25 13:50:17,679 - __main__ - INFO - Scrape OK: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ — persisting to DB
2025-08-25 13:50:17,734 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:50:21,669 - root - INFO - Updating existing property: Axiom Apartments
2025-08-25 13:50:26,669 - root - INFO - Successfully processed and committed property: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:50:26,685 - __main__ - INFO - Persisted.
2025-08-25 13:50:30,104 - __main__ - INFO - Deleted message for https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 14:10:29,021 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/ with status: Success
2025-08-25 14:10:30,302 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/ — persisting to DB
2025-08-25 14:10:30,345 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:10:34,112 - root - INFO - Inserting new property: The Andi
2025-08-25 14:10:37,275 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 14:10:37,281 - __main__ - INFO - Persisted.
2025-08-25 14:10:39,296 - __main__ - INFO - Deleted message for https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 14:10:51,477 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:10:51,570 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:10:51,685 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:10:51,685 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:10:51,700 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:10:51,700 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:10:51,738 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:10:51,738 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:11:09,967 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:11:11,456 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:11:11,999 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:11:12,067 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:11:16,313 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:11:16,313 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ with status: Failed: Critical Data Missing
2025-08-25 14:11:16,434 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ reason=Failed: Critical Data Missing
2025-08-25 14:11:16,460 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:11:16,461 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ with status: Failed: Critical Data Missing
2025-08-25 14:11:16,748 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ reason=Failed: Critical Data Missing
2025-08-25 14:17:41,329 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/ with status: Success
2025-08-25 14:17:41,386 - __main__ - INFO - Scrape OK: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/ — persisting to DB
2025-08-25 14:17:41,477 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:17:42,439 - root - INFO - Inserting new property: Fenway Parkside
2025-08-25 14:17:43,652 - root - INFO - Successfully processed and committed property: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:17:43,655 - __main__ - INFO - Persisted.
2025-08-25 14:17:44,885 - __main__ - INFO - Deleted message for https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:42:25,605 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/ with status: Success
2025-08-25 14:42:27,601 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/ — persisting to DB
2025-08-25 14:42:27,610 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:42:28,820 - root - INFO - Updating existing property: The Adams at Hancock Village
2025-08-25 14:42:30,856 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:42:30,858 - __main__ - INFO - Persisted.
2025-08-25 14:42:32,740 - __main__ - INFO - Deleted message for https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:43:06,963 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:43:07,052 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:43:07,162 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:43:07,162 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:43:31,044 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:43:31,082 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:43:34,727 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:43:34,727 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ with status: Failed: Critical Data Missing
2025-08-25 14:43:34,754 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ reason=Failed: Critical Data Missing
2025-08-25 14:53:04,889 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/ with status: Success
2025-08-25 14:53:04,980 - __main__ - INFO - Scrape OK: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/ — persisting to DB
2025-08-25 14:53:05,040 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:53:05,863 - root - INFO - Inserting new property: Beacon Park Apartments
2025-08-25 14:53:16,534 - root - INFO - Successfully processed and committed property: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:53:16,538 - __main__ - INFO - Persisted.
2025-08-25 14:53:18,229 - __main__ - INFO - Deleted message for https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:53:43,584 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:53:43,587 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:53:49,430 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:53:49,431 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:54:25,075 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:54:29,977 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:54:32,829 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:32,829 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ with status: Failed: Critical Data Missing
2025-08-25 14:54:32,839 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ reason=Failed: Critical Data Missing
2025-08-25 14:54:33,502 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:33,502 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-25 14:54:33,532 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-25 14:54:35,763 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:54:35,764 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:54:40,884 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:54:42,065 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:42,065 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ with status: Failed: Critical Data Missing
2025-08-25 14:54:42,087 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ reason=Failed: Critical Data Missing
2025-08-25 14:54:44,737 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:54:44,737 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:54:44,758 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:54:44,759 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:54:48,523 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:54:50,209 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:54:52,409 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:52,410 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ with status: Failed: Critical Data Missing
2025-08-25 14:54:52,746 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ reason=Failed: Critical Data Missing
2025-08-25 14:54:53,587 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:53,588 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ with status: Failed: Critical Data Missing
2025-08-25 14:54:53,614 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ reason=Failed: Critical Data Missing
2025-08-25 14:54:55,171 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 14:54:55,171 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 14:54:56,996 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 14:54:57,342 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:57,377 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ with status: Failed: Critical Data Missing
2025-08-25 14:54:57,416 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ reason=Failed: Critical Data Missing
2025-08-25 14:54:59,054 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:54:59,054 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:54:59,300 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:54:59,301 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:04,693 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:06,906 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:07,332 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:07,332 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ with status: Failed: Critical Data Missing
2025-08-25 14:55:07,358 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ reason=Failed: Critical Data Missing
2025-08-25 14:55:07,976 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:07,977 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-25 14:55:08,451 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-25 14:55:10,356 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:55:10,357 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:55:14,225 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:55:16,554 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:16,555 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ with status: Failed: Critical Data Missing
2025-08-25 14:55:16,582 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ reason=Failed: Critical Data Missing
2025-08-25 14:55:18,425 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:55:18,435 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:55:18,549 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:55:18,550 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:55:22,730 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:55:23,454 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:55:23,605 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:23,605 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ with status: Failed: Critical Data Missing
2025-08-25 14:55:23,623 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ reason=Failed: Critical Data Missing
2025-08-25 14:55:24,563 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:24,564 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ with status: Failed: Critical Data Missing
2025-08-25 14:55:24,581 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ reason=Failed: Critical Data Missing
2025-08-25 14:55:29,417 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:29,418 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:29,427 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:29,427 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:32,951 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:33,154 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:34,303 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:34,303 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-25 14:55:34,308 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:34,309 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ with status: Failed: Critical Data Missing
2025-08-25 14:55:34,515 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-25 14:55:34,649 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ reason=Failed: Critical Data Missing
2025-08-25 15:57:36,561 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-25 15:57:43,827 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-25 15:57:50,955 - __main__ - CRITICAL - Unhandled critical error in main: Browser.close: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 198, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 190, in main
    async with ApartmentScraper(p) as scraper:
               ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 49, in __aexit__
    await self.browser.close()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 14223, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 195, in close
    raise e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 192, in close
    await self._channel.send("close", {"reason": reason})
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver
