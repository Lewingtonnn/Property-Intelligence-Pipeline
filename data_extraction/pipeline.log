2025-08-23 23:00:14,445 - __main__ - INFO - Prometheus HTTP server started.
2025-08-23 23:00:14,675 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-23 23:00:22,351 - __main__ - INFO - Starting SQS consumer...
2025-08-23 23:00:42,871 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:00:42,872 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:00:49,850 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:11:32,612 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/ with status: Success
2025-08-23 23:11:33,540 - __main__ - INFO - Successfully scraped and validated data for https://www.apartments.com/longwood-row-boston-ma/kp71r5c/.
2025-08-23 23:11:33,646 - root - INFO - Starting to save 1 properties to the database...
2025-08-23 23:11:52,125 - root - INFO - Updating existing property: Longwood Row
2025-08-23 23:11:54,024 - root - INFO - Successfully processed and committed property: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-23 23:11:59,202 - __main__ - INFO - Successfully deleted message for https://www.apartments.com/longwood-row-boston-ma/kp71r5c/ from queue.
2025-08-23 23:12:29,801 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/proto-kendall-square-cambridge-ma/wvwfs4l/
2025-08-23 23:12:29,852 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/proto-kendall-square-cambridge-ma/wvwfs4l/
2025-08-23 23:12:39,659 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/proto-kendall-square-cambridge-ma/wvwfs4l/
2025-08-23 23:26:19,186 - asyncio - ERROR - Future exception was never retrieved
future: <Future finished exception=TargetClosedError('Target page, context or browser has been closed\nCall log:\n  - waiting for locator("li.unitContainer").nth(12).locator(".rentLabel")\n')>
playwright._impl._errors.TargetClosedError: Target page, context or browser has been closed
Call log:
  - waiting for locator("li.unitContainer").nth(12).locator(".rentLabel")

2025-08-24 12:22:54,568 - __main__ - INFO - Starting the producer orchestration.
2025-08-24 12:22:54,719 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 12:23:02,694 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-24 12:24:40,808 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-24 12:24:56,001 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-24 12:24:56,006 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-24 12:25:39,203 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:25:46,001 - data_extraction.scraper - INFO - Scraping page 2...
2025-08-24 12:26:05,357 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:06,867 - data_extraction.scraper - INFO - Scraping page 3...
2025-08-24 12:26:16,367 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:17,767 - data_extraction.scraper - INFO - Scraping page 4...
2025-08-24 12:26:24,881 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:26,273 - data_extraction.scraper - INFO - Scraping page 5...
2025-08-24 12:26:33,595 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:34,971 - data_extraction.scraper - INFO - Scraping page 6...
2025-08-24 12:26:42,469 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:44,132 - data_extraction.scraper - INFO - Scraping page 7...
2025-08-24 12:26:50,804 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:26:52,255 - data_extraction.scraper - INFO - Scraping page 8...
2025-08-24 12:27:00,022 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:01,434 - data_extraction.scraper - INFO - Scraping page 9...
2025-08-24 12:27:09,146 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:10,728 - data_extraction.scraper - INFO - Scraping page 10...
2025-08-24 12:27:17,617 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:18,961 - data_extraction.scraper - INFO - Scraping page 11...
2025-08-24 12:27:21,783 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:23,109 - data_extraction.scraper - INFO - Scraping page 12...
2025-08-24 12:27:25,731 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:27,139 - data_extraction.scraper - INFO - Scraping page 13...
2025-08-24 12:27:30,221 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:31,605 - data_extraction.scraper - INFO - Scraping page 14...
2025-08-24 12:27:34,386 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:35,835 - data_extraction.scraper - INFO - Scraping page 15...
2025-08-24 12:27:38,185 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:39,562 - data_extraction.scraper - INFO - Scraping page 16...
2025-08-24 12:27:42,514 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:43,934 - data_extraction.scraper - INFO - Scraping page 17...
2025-08-24 12:27:46,525 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-24 12:27:47,989 - data_extraction.scraper - INFO - Scraping page 18...
2025-08-24 12:27:49,815 - data_extraction.scraper - INFO - No more pages found. Ending pagination.
2025-08-24 12:27:49,994 - data_extraction.scraper - INFO - Scraping complete. Extracted 699 unique property URLs.
2025-08-24 12:27:49,995 - __main__ - INFO - Found 699 properties. Sending 10 URLs to SQS.
2025-08-24 12:27:51,390 - __main__ - INFO - All messages sent to SQS.
2025-08-24 12:27:53,980 - __main__ - INFO - Producer process completed.
2025-08-24 12:29:13,912 - __main__ - INFO - Prometheus HTTP server started.
2025-08-24 12:29:13,939 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 12:29:15,803 - __main__ - INFO - Starting SQS consumer...
2025-08-24 12:29:44,898 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:29:44,900 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:29:56,233 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:42:12,962 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ with status: Success
2025-08-24 12:42:13,229 - __main__ - INFO - Successfully scraped and validated data for https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/.
2025-08-24 12:42:13,230 - root - INFO - Starting to save 1 properties to the database...
2025-08-24 12:42:19,703 - root - INFO - Inserting new property: Axiom Apartments
2025-08-24 12:42:20,870 - root - INFO - Successfully processed and committed property: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-24 12:42:21,895 - __main__ - INFO - Successfully deleted message for https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ from queue.
2025-08-24 12:42:35,638 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/
2025-08-24 12:42:35,640 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/
2025-08-24 12:42:43,665 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/
2025-08-24 12:42:44,370 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-24 12:42:44,370 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/ with status: Failed: Critical Data Missing
2025-08-24 12:42:44,396 - __main__ - ERROR - Validation failed for URL: https://www.apartments.com/105-charles-st-boston-ma-unit-1/z9md88y/. Error: Failed: Critical Data Missing
2025-08-24 12:42:55,413 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/
2025-08-24 12:42:55,414 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/
2025-08-24 12:43:00,497 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/
2025-08-24 12:43:01,305 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-24 12:43:01,306 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/ with status: Failed: Critical Data Missing
2025-08-24 12:43:01,367 - __main__ - ERROR - Validation failed for URL: https://www.apartments.com/1986-commonwealth-ave-boston-ma-unit-4/s0m4ne6/. Error: Failed: Critical Data Missing
2025-08-24 12:43:10,896 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/
2025-08-24 12:43:10,896 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/
2025-08-24 12:43:15,199 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/
2025-08-24 12:43:16,279 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-24 12:43:16,279 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/ with status: Failed: Critical Data Missing
2025-08-24 12:43:16,296 - __main__ - ERROR - Validation failed for URL: https://www.apartments.com/173-magnolia-st-boston-ma-unit-4/bxjjpbc/. Error: Failed: Critical Data Missing
2025-08-24 12:43:27,779 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/
2025-08-24 12:43:27,780 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/
2025-08-24 12:43:33,073 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/
2025-08-24 12:56:32,944 - __main__ - INFO - Prometheus HTTP server started.
2025-08-24 12:56:32,974 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 12:56:40,838 - __main__ - INFO - Starting SQS consumer...
2025-08-24 13:08:21,765 - __main__ - CRITICAL - Critical error processing URL https://www.apartments.com/avalon-north-station-boston-ma/d4j183k/: Browser.close: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 52, in process_message
    async with ApartmentScraper(p) as scraper:
               ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 49, in __aexit__
    await self.browser.close()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 14223, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 195, in close
    raise e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 192, in close
    await self._channel.send("close", {"reason": reason})
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver
2025-08-24 13:31:21,548 - __main__ - INFO - Prometheus HTTP server started.
2025-08-24 13:31:21,651 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-24 13:31:37,552 - __main__ - INFO - Starting SQS consumer...
2025-08-24 13:31:43,216 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:48:53,544 - __main__ - INFO - Prometheus HTTP server started.
2025-08-25 11:48:53,650 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 11:48:59,164 - __main__ - INFO - Starting SQS consumer...
2025-08-25 11:49:00,849 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:11,121 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:21,397 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:31,681 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:42,056 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:49:52,399 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:02,711 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:13,083 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:23,363 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:33,662 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:43,944 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:50:54,248 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:51:04,588 - __main__ - ERROR - An error occurred during polling: process_message() missing 1 required positional argument: 'scraper'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 114, in poll_sqs_for_messages
    await process_message(sqs_client, message)
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: process_message() missing 1 required positional argument: 'scraper'
2025-08-25 11:58:29,456 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-25 11:58:41,827 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 11:58:44,442 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-25 11:58:44,454 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-25 11:58:48,142 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 11:58:48,143 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 11:58:53,041 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 12:21:16,536 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-25 12:21:17,123 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 103, in scrape_single_property_page
    try:
    
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-25 12:21:17,273 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/ reason=Failed: Exception
2025-08-25 12:21:17,304 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-25 12:21:17,636 - __main__ - INFO - Consumer process exited.
2025-08-25 12:22:01,609 - __main__ - INFO - Starting the producer orchestration.
2025-08-25 12:22:01,628 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 12:22:05,142 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-25 12:22:23,652 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-25 12:22:28,729 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-25 12:22:28,730 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-25 12:22:41,276 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:22:45,353 - data_extraction.scraper - INFO - Scraping page 2...
2025-08-25 12:22:55,726 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:22:57,338 - data_extraction.scraper - INFO - Scraping page 3...
2025-08-25 12:23:04,933 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:06,278 - data_extraction.scraper - INFO - Scraping page 4...
2025-08-25 12:23:11,645 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:12,989 - data_extraction.scraper - INFO - Scraping page 5...
2025-08-25 12:23:17,295 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:18,546 - data_extraction.scraper - INFO - Scraping page 6...
2025-08-25 12:23:23,034 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:25,293 - data_extraction.scraper - INFO - Scraping page 7...
2025-08-25 12:23:34,971 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:38,096 - data_extraction.scraper - INFO - Scraping page 8...
2025-08-25 12:23:43,873 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:45,329 - data_extraction.scraper - INFO - Scraping page 9...
2025-08-25 12:23:48,715 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:50,155 - data_extraction.scraper - INFO - Scraping page 10...
2025-08-25 12:23:55,513 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:23:56,736 - data_extraction.scraper - INFO - Scraping page 11...
2025-08-25 12:23:59,826 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:01,257 - data_extraction.scraper - INFO - Scraping page 12...
2025-08-25 12:24:03,956 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:05,295 - data_extraction.scraper - INFO - Scraping page 13...
2025-08-25 12:24:08,260 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:10,058 - data_extraction.scraper - INFO - Scraping page 14...
2025-08-25 12:24:15,861 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:17,668 - data_extraction.scraper - INFO - Scraping page 15...
2025-08-25 12:24:21,995 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:25,978 - data_extraction.scraper - INFO - Scraping page 16...
2025-08-25 12:24:32,001 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:33,540 - data_extraction.scraper - INFO - Scraping page 17...
2025-08-25 12:24:41,872 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-25 12:24:43,360 - data_extraction.scraper - INFO - Scraping page 18...
2025-08-25 12:24:45,871 - data_extraction.scraper - INFO - No more pages found. Ending pagination.
2025-08-25 12:24:46,814 - data_extraction.scraper - INFO - Scraping complete. Extracted 700 unique property URLs.
2025-08-25 12:24:46,815 - __main__ - INFO - Found 700 properties. Sending 10 URLs to SQS.
2025-08-25 12:24:48,149 - __main__ - INFO - All messages sent to SQS.
2025-08-25 12:24:55,232 - __main__ - INFO - Producer process completed.
2025-08-25 12:37:38,741 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-25 12:37:54,353 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-25 12:38:01,224 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-25 12:38:01,237 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-25 12:38:08,720 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 12:38:08,721 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 12:38:09,457 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 12:38:09,457 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 12:38:23,395 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 12:38:23,509 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 13:01:06,626 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/ with status: Success
2025-08-25 13:01:07,650 - __main__ - INFO - Scrape OK: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/ — persisting to DB
2025-08-25 13:01:07,671 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:01:21,652 - root - INFO - Updating existing property: 1410 Columbia
2025-08-25 13:01:25,705 - root - INFO - Successfully processed and committed property: https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 13:01:25,706 - __main__ - INFO - Persisted.
2025-08-25 13:01:28,673 - __main__ - INFO - Deleted message for https://www.apartments.com/1410-columbia-south-boston-ma/y0fgdsr/
2025-08-25 13:05:13,257 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/ with status: Success
2025-08-25 13:05:13,413 - __main__ - INFO - Scrape OK: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/ — persisting to DB
2025-08-25 13:05:13,413 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:05:14,045 - root - INFO - Inserting new property: One Canal Apartments
2025-08-25 13:05:15,377 - root - INFO - Successfully processed and committed property: https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 13:05:15,378 - __main__ - INFO - Persisted.
2025-08-25 13:05:16,494 - __main__ - INFO - Deleted message for https://www.apartments.com/one-canal-apartments-boston-ma/z17ct3x/
2025-08-25 13:05:20,367 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:05:20,382 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:05:23,656 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:36:51,687 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/ with status: Success
2025-08-25 13:36:53,061 - __main__ - INFO - Scrape OK: https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/ — persisting to DB
2025-08-25 13:36:53,128 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:36:55,122 - root - INFO - Updating existing property: Cambridge Ivy Inn
2025-08-25 13:36:56,278 - root - ERROR - Integrity Error for https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "property_reviews" of relation "property" violates not-null constraint
DETAIL:  Failing row contains (101, Cambridge Ivy Inn, https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cv..., Cambridge, MA, 02138, N/A, null, null, 1900, N/A, Cambridge, MA, 02138, Success, Apartment, ["3, 4, 5, 6, 7, 8, 9, 10, 11, 12", "Short term lease"], 2025-08-25 10:36:53.46837).
[SQL: UPDATE property SET address=$1::VARCHAR, property_reviews=$2::FLOAT, street=$3::VARCHAR, city=$4::VARCHAR, lease_option=$5::VARCHAR, timestamp=$6::TIMESTAMP WITHOUT TIME ZONE WHERE property.id = $7::INTEGER]
[parameters: ('Cambridge, MA, 02138', None, 'N/A', 'Cambridge', '["3, 4, 5, 6, 7, 8, 9, 10, 11, 12", "Short term lease"]', datetime.datetime(2025, 8, 25, 10, 36, 53, 468370), 101)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-25 13:36:56,282 - __main__ - INFO - Persisted.
2025-08-25 13:36:58,468 - __main__ - INFO - Deleted message for https://www.apartments.com/cambridge-ivy-inn-cambridge-ma/yjy0cvv/
2025-08-25 13:37:10,679 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:37:10,738 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:37:10,782 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 13:37:10,783 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 13:37:10,787 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 13:37:10,787 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 13:37:21,850 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:37:22,284 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 13:37:22,322 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 13:37:23,096 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 13:37:23,346 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ with status: Failed: Critical Data Missing
2025-08-25 13:37:23,389 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ reason=Failed: Critical Data Missing
2025-08-25 13:50:15,580 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ with status: Success
2025-08-25 13:50:17,679 - __main__ - INFO - Scrape OK: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/ — persisting to DB
2025-08-25 13:50:17,734 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 13:50:21,669 - root - INFO - Updating existing property: Axiom Apartments
2025-08-25 13:50:26,669 - root - INFO - Successfully processed and committed property: https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 13:50:26,685 - __main__ - INFO - Persisted.
2025-08-25 13:50:30,104 - __main__ - INFO - Deleted message for https://www.apartments.com/axiom-apartments-cambridge-ma/srj4z66/
2025-08-25 14:10:29,021 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/ with status: Success
2025-08-25 14:10:30,302 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/ — persisting to DB
2025-08-25 14:10:30,345 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:10:34,112 - root - INFO - Inserting new property: The Andi
2025-08-25 14:10:37,275 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 14:10:37,281 - __main__ - INFO - Persisted.
2025-08-25 14:10:39,296 - __main__ - INFO - Deleted message for https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-25 14:10:51,477 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:10:51,570 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:10:51,685 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:10:51,685 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:10:51,700 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:10:51,700 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:10:51,738 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:10:51,738 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:11:09,967 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:11:11,456 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:11:11,999 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:11:12,067 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:11:16,313 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:11:16,313 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ with status: Failed: Critical Data Missing
2025-08-25 14:11:16,434 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ reason=Failed: Critical Data Missing
2025-08-25 14:11:16,460 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:11:16,461 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ with status: Failed: Critical Data Missing
2025-08-25 14:11:16,748 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ reason=Failed: Critical Data Missing
2025-08-25 14:17:41,329 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/ with status: Success
2025-08-25 14:17:41,386 - __main__ - INFO - Scrape OK: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/ — persisting to DB
2025-08-25 14:17:41,477 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:17:42,439 - root - INFO - Inserting new property: Fenway Parkside
2025-08-25 14:17:43,652 - root - INFO - Successfully processed and committed property: https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:17:43,655 - __main__ - INFO - Persisted.
2025-08-25 14:17:44,885 - __main__ - INFO - Deleted message for https://www.apartments.com/fenway-parkside-boston-ma/w88trdl/
2025-08-25 14:42:25,605 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/ with status: Success
2025-08-25 14:42:27,601 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/ — persisting to DB
2025-08-25 14:42:27,610 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:42:28,820 - root - INFO - Updating existing property: The Adams at Hancock Village
2025-08-25 14:42:30,856 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:42:30,858 - __main__ - INFO - Persisted.
2025-08-25 14:42:32,740 - __main__ - INFO - Deleted message for https://www.apartments.com/the-adams-at-hancock-village-chestnut-hill-ma/1wnl587/
2025-08-25 14:43:06,963 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:43:07,052 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:43:07,162 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:43:07,162 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:43:31,044 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:43:31,082 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:43:34,727 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:43:34,727 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ with status: Failed: Critical Data Missing
2025-08-25 14:43:34,754 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ reason=Failed: Critical Data Missing
2025-08-25 14:53:04,889 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/ with status: Success
2025-08-25 14:53:04,980 - __main__ - INFO - Scrape OK: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/ — persisting to DB
2025-08-25 14:53:05,040 - root - INFO - Starting to save 1 properties to the database...
2025-08-25 14:53:05,863 - root - INFO - Inserting new property: Beacon Park Apartments
2025-08-25 14:53:16,534 - root - INFO - Successfully processed and committed property: https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:53:16,538 - __main__ - INFO - Persisted.
2025-08-25 14:53:18,229 - __main__ - INFO - Deleted message for https://www.apartments.com/beacon-park-apartments-brookline-ma/6pnb3wv/
2025-08-25 14:53:43,584 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:53:43,587 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:53:49,430 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:53:49,431 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:54:25,075 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:54:29,977 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:54:32,829 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:32,829 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ with status: Failed: Critical Data Missing
2025-08-25 14:54:32,839 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ reason=Failed: Critical Data Missing
2025-08-25 14:54:33,502 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:33,502 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-25 14:54:33,532 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-25 14:54:35,763 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:54:35,764 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:54:40,884 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:54:42,065 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:42,065 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ with status: Failed: Critical Data Missing
2025-08-25 14:54:42,087 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ reason=Failed: Critical Data Missing
2025-08-25 14:54:44,737 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:54:44,737 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:54:44,758 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:54:44,759 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:54:48,523 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:54:50,209 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:54:52,409 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:52,410 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ with status: Failed: Critical Data Missing
2025-08-25 14:54:52,746 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ reason=Failed: Critical Data Missing
2025-08-25 14:54:53,587 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:53,588 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ with status: Failed: Critical Data Missing
2025-08-25 14:54:53,614 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ reason=Failed: Critical Data Missing
2025-08-25 14:54:55,171 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 14:54:55,171 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 14:54:56,996 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/
2025-08-25 14:54:57,342 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:54:57,377 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ with status: Failed: Critical Data Missing
2025-08-25 14:54:57,416 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/75-desoto-rd-boston-ma-unit-1/7wt9x9w/ reason=Failed: Critical Data Missing
2025-08-25 14:54:59,054 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:54:59,054 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:54:59,300 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:54:59,301 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:04,693 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:06,906 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:07,332 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:07,332 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ with status: Failed: Critical Data Missing
2025-08-25 14:55:07,358 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ reason=Failed: Critical Data Missing
2025-08-25 14:55:07,976 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:07,977 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-25 14:55:08,451 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-25 14:55:10,356 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:55:10,357 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:55:14,225 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/
2025-08-25 14:55:16,554 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:16,555 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ with status: Failed: Critical Data Missing
2025-08-25 14:55:16,582 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/157-e-cottage-st-boston-ma/0b2qfp2/ reason=Failed: Critical Data Missing
2025-08-25 14:55:18,425 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:55:18,435 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:55:18,549 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:55:18,550 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:55:22,730 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/
2025-08-25 14:55:23,454 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/
2025-08-25 14:55:23,605 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:23,605 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ with status: Failed: Critical Data Missing
2025-08-25 14:55:23,623 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/57-salem-st-boston-ma/pbltjyt/ reason=Failed: Critical Data Missing
2025-08-25 14:55:24,563 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:24,564 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ with status: Failed: Critical Data Missing
2025-08-25 14:55:24,581 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/8-chauncey-st-watertown-ma/kcg96sc/ reason=Failed: Critical Data Missing
2025-08-25 14:55:29,417 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:29,418 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:29,427 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:29,427 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:32,951 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-25 14:55:33,154 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/
2025-08-25 14:55:34,303 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:34,303 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-25 14:55:34,308 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-25 14:55:34,309 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ with status: Failed: Critical Data Missing
2025-08-25 14:55:34,515 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-25 14:55:34,649 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-kinnaird-st-cambridge-ma-unit-fl2-id1154/387t2md/ reason=Failed: Critical Data Missing
2025-08-25 15:57:36,561 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-25 15:57:43,827 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-25 15:57:50,955 - __main__ - CRITICAL - Unhandled critical error in main: Browser.close: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 198, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 190, in main
    async with ApartmentScraper(p) as scraper:
               ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 49, in __aexit__
    await self.browser.close()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 14223, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 195, in close
    raise e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 192, in close
    await self._channel.send("close", {"reason": reason})
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver
2025-08-28 00:51:25,508 - __main__ - INFO - Starting the producer orchestration.
2025-08-28 00:51:25,570 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 00:51:34,972 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-28 00:52:41,859 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-28 00:52:47,757 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-28 00:52:47,761 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-28 00:52:59,840 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:02,475 - data_extraction.scraper - INFO - Scraping page 2...
2025-08-28 00:53:11,712 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:13,159 - data_extraction.scraper - INFO - Scraping page 3...
2025-08-28 00:53:17,123 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:18,466 - data_extraction.scraper - INFO - Scraping page 4...
2025-08-28 00:53:23,125 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:24,837 - data_extraction.scraper - INFO - Scraping page 5...
2025-08-28 00:53:27,781 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:29,067 - data_extraction.scraper - INFO - Scraping page 6...
2025-08-28 00:53:31,410 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:32,862 - data_extraction.scraper - INFO - Scraping page 7...
2025-08-28 00:53:35,591 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:36,970 - data_extraction.scraper - INFO - Scraping page 8...
2025-08-28 00:53:39,349 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:40,583 - data_extraction.scraper - INFO - Scraping page 9...
2025-08-28 00:53:43,329 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:44,698 - data_extraction.scraper - INFO - Scraping page 10...
2025-08-28 00:53:47,013 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:48,339 - data_extraction.scraper - INFO - Scraping page 11...
2025-08-28 00:53:54,077 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:53:56,534 - data_extraction.scraper - INFO - Scraping page 12...
2025-08-28 00:54:00,150 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:54:02,888 - data_extraction.scraper - INFO - Scraping page 13...
2025-08-28 00:54:05,194 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:54:06,482 - data_extraction.scraper - INFO - Scraping page 14...
2025-08-28 00:54:10,042 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:54:11,425 - data_extraction.scraper - INFO - Scraping page 15...
2025-08-28 00:54:13,991 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:54:15,229 - data_extraction.scraper - INFO - Scraping page 16...
2025-08-28 00:54:17,579 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:54:19,014 - data_extraction.scraper - INFO - Scraping page 17...
2025-08-28 00:54:21,565 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:54:23,052 - data_extraction.scraper - INFO - Scraping page 18...
2025-08-28 00:54:24,793 - data_extraction.scraper - INFO - No more pages found. Ending pagination.
2025-08-28 00:54:25,539 - data_extraction.scraper - INFO - Scraping complete. Extracted 692 unique property URLs.
2025-08-28 00:54:25,540 - __main__ - INFO - Found 692 properties. Sending 692 URLs to SQS.
2025-08-28 00:54:56,015 - __main__ - INFO - Starting the producer orchestration.
2025-08-28 00:54:56,116 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 00:54:59,552 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-28 00:55:08,575 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-28 00:55:14,371 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-28 00:55:14,373 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-28 00:55:20,571 - data_extraction.scraper - ERROR - Error during multi-page scraping: 'list' object has no attribute 'add'
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 74, in scrape_all_pages
    property_urls_set.add(href)
    ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'add'
2025-08-28 00:55:20,689 - data_extraction.scraper - INFO - Scraping complete. Extracted 0 unique property URLs.
2025-08-28 00:55:20,689 - __main__ - INFO - Found 0 properties. Sending 0 URLs to SQS.
2025-08-28 00:55:20,690 - __main__ - INFO - All messages sent to SQS.
2025-08-28 00:55:27,915 - __main__ - INFO - Producer process completed.
2025-08-28 00:57:10,636 - __main__ - INFO - Starting the producer orchestration.
2025-08-28 00:57:10,663 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 00:57:17,531 - __main__ - INFO - Successfully connected to SQS queue at https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs.
2025-08-28 00:57:39,412 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/boston-ma/
2025-08-28 00:57:45,423 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/boston-ma/
2025-08-28 00:57:45,423 - data_extraction.scraper - INFO - Scraping page 1...
2025-08-28 00:58:09,626 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:58:14,541 - data_extraction.scraper - INFO - Scraping page 2...
2025-08-28 00:58:26,073 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:58:27,560 - data_extraction.scraper - INFO - Scraping page 3...
2025-08-28 00:58:45,508 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:58:46,900 - data_extraction.scraper - INFO - Scraping page 4...
2025-08-28 00:58:56,433 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:58:57,823 - data_extraction.scraper - INFO - Scraping page 5...
2025-08-28 00:59:08,035 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:59:09,634 - data_extraction.scraper - INFO - Scraping page 6...
2025-08-28 00:59:19,160 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:59:20,490 - data_extraction.scraper - INFO - Scraping page 7...
2025-08-28 00:59:27,379 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:59:28,722 - data_extraction.scraper - INFO - Scraping page 8...
2025-08-28 00:59:37,022 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:59:38,344 - data_extraction.scraper - INFO - Scraping page 9...
2025-08-28 00:59:46,143 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:59:47,483 - data_extraction.scraper - INFO - Scraping page 10...
2025-08-28 00:59:53,711 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 00:59:55,074 - data_extraction.scraper - INFO - Scraping page 11...
2025-08-28 00:59:58,851 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:00,161 - data_extraction.scraper - INFO - Scraping page 12...
2025-08-28 01:00:03,422 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:04,805 - data_extraction.scraper - INFO - Scraping page 13...
2025-08-28 01:00:07,261 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:08,566 - data_extraction.scraper - INFO - Scraping page 14...
2025-08-28 01:00:11,978 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:13,452 - data_extraction.scraper - INFO - Scraping page 15...
2025-08-28 01:00:16,927 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:18,476 - data_extraction.scraper - INFO - Scraping page 16...
2025-08-28 01:00:20,951 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:22,292 - data_extraction.scraper - INFO - Scraping page 17...
2025-08-28 01:00:25,625 - data_extraction.scraper - INFO - Clicking the 'next' page button...
2025-08-28 01:00:26,993 - data_extraction.scraper - INFO - Scraping page 18...
2025-08-28 01:00:28,944 - data_extraction.scraper - INFO - No more pages found. Ending pagination.
2025-08-28 01:00:29,644 - data_extraction.scraper - INFO - Scraping complete. Extracted 2018 unique property URLs.
2025-08-28 01:00:29,644 - __main__ - INFO - Found 2018 properties. Sending 2018 URLs to SQS.
2025-08-28 01:01:33,496 - __main__ - INFO - All messages sent to SQS.
2025-08-28 01:01:35,115 - __main__ - INFO - Producer process completed.
2025-08-28 01:04:00,200 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 01:04:13,310 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 01:04:16,333 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 01:04:16,351 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-28 01:04:19,340 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/
2025-08-28 01:04:19,343 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/
2025-08-28 01:04:21,689 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/
2025-08-28 01:04:21,689 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/
2025-08-28 01:04:22,288 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/
2025-08-28 01:04:22,289 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/
2025-08-28 01:04:23,019 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/
2025-08-28 01:04:23,019 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/
2025-08-28 01:04:23,492 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/
2025-08-28 01:04:23,492 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/
2025-08-28 01:04:30,348 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/
2025-08-28 01:04:30,427 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/
2025-08-28 01:04:30,680 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/
2025-08-28 01:04:31,463 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/
2025-08-28 01:04:31,696 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/
2025-08-28 01:04:33,814 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:04:33,814 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/ with status: Failed: Critical Data Missing
2025-08-28 01:04:34,185 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/ reason=Failed: Critical Data Missing
2025-08-28 01:04:37,208 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/
2025-08-28 01:04:37,208 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/
2025-08-28 01:05:12,122 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/
2025-08-28 01:05:13,089 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:05:13,090 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/ with status: Failed: Critical Data Missing
2025-08-28 01:05:13,100 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/ reason=Failed: Critical Data Missing
2025-08-28 01:05:14,875 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/
2025-08-28 01:05:14,876 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/
2025-08-28 01:05:22,274 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/
2025-08-28 01:05:22,795 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:05:22,795 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/ with status: Failed: Critical Data Missing
2025-08-28 01:05:22,809 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/ reason=Failed: Critical Data Missing
2025-08-28 01:05:23,651 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/
2025-08-28 01:05:23,652 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/
2025-08-28 01:05:30,585 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/
2025-08-28 01:05:31,391 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:05:31,392 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/ with status: Failed: Critical Data Missing
2025-08-28 01:05:31,408 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/15-dana-ave-boston-ma/008mms1/ reason=Failed: Critical Data Missing
2025-08-28 01:05:32,163 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/
2025-08-28 01:05:32,164 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/
2025-08-28 01:05:39,117 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/ with status: Success
2025-08-28 01:05:39,208 - __main__ - INFO - Scrape OK: https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/ — persisting to DB
2025-08-28 01:05:39,213 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 01:05:39,537 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/
2025-08-28 01:05:40,284 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:05:40,284 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/ with status: Failed: Critical Data Missing
2025-08-28 01:05:40,391 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/ reason=Failed: Critical Data Missing
2025-08-28 01:05:41,239 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-28 01:05:41,239 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-28 01:05:45,890 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-28 01:05:46,930 - root - INFO - Inserting new property: Magazine Street Apartments
2025-08-28 01:05:46,980 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:05:46,981 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-28 01:05:47,091 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-28 01:05:47,566 - root - ERROR - Error saving property https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/ to database: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 5, 39... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO property (title, property_link, address, listing_verification, property_reviews, price, year_built, street, city, state, zip_code, validation_status, property_type, lease_option, timestamp) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::INTEGER, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::TIMESTAMP WITHOUT TIME ZONE) RETURNING property.id]
[parameters: ('Magazine Street Apartments', 'https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/', 'Cambridge, MA, 02139', 'N/A', 0, None, 1905.0, 'N/A', 'Cambridge', 'MA', '02139', 'Success', 'Apartment', None, datetime.datetime(2025, 8, 27, 22, 5, 39, 230228, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 5, 39... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 5, 39... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\database_ops\db_ops.py", line 154, in save_scraped_data_to_db
    await session.flush()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 801, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
        statement,
        params,
        execution_options=execution_options,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1413, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1840, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1980, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 5, 39... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO property (title, property_link, address, listing_verification, property_reviews, price, year_built, street, city, state, zip_code, validation_status, property_type, lease_option, timestamp) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::INTEGER, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::TIMESTAMP WITHOUT TIME ZONE) RETURNING property.id]
[parameters: ('Magazine Street Apartments', 'https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/', 'Cambridge, MA, 02139', 'N/A', 0, None, 1905.0, 'N/A', 'Cambridge', 'MA', '02139', 'Success', 'Apartment', None, datetime.datetime(2025, 8, 27, 22, 5, 39, 230228, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-08-28 01:05:54,266 - __main__ - INFO - Persisted.
2025-08-28 01:05:55,216 - __main__ - INFO - Deleted message for https://www.apartments.com/magazine-street-apartments-cambridge-ma/fpcrxpv/
2025-08-28 01:08:44,007 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/ with status: Success
2025-08-28 01:08:44,018 - __main__ - INFO - Scrape OK: https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/ — persisting to DB
2025-08-28 01:08:44,018 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 01:08:44,472 - root - INFO - Inserting new property: Winter Street Apartments, 8
2025-08-28 01:08:44,703 - root - ERROR - Error saving property https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/ to database: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 8, 44... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO property (title, property_link, address, listing_verification, property_reviews, price, year_built, street, city, state, zip_code, validation_status, property_type, lease_option, timestamp) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::INTEGER, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::TIMESTAMP WITHOUT TIME ZONE) RETURNING property.id]
[parameters: ('Winter Street Apartments, 8', 'https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/', 'Boston, MA, 02108', 'Verified Listing', 3.9, None, 2013.0, 'N/A', 'Boston', 'MA', '02108', 'Success', 'Apartment', None, datetime.datetime(2025, 8, 27, 22, 8, 44, 18754, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 8, 44... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 8, 44... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\database_ops\db_ops.py", line 154, in save_scraped_data_to_db
    await session.flush()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 801, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
        statement,
        params,
        execution_options=execution_options,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1413, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1840, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1980, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 8, 44... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO property (title, property_link, address, listing_verification, property_reviews, price, year_built, street, city, state, zip_code, validation_status, property_type, lease_option, timestamp) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::INTEGER, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::TIMESTAMP WITHOUT TIME ZONE) RETURNING property.id]
[parameters: ('Winter Street Apartments, 8', 'https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/', 'Boston, MA, 02108', 'Verified Listing', 3.9, None, 2013.0, 'N/A', 'Boston', 'MA', '02108', 'Success', 'Apartment', None, datetime.datetime(2025, 8, 27, 22, 8, 44, 18754, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-08-28 01:08:44,722 - __main__ - INFO - Persisted.
2025-08-28 01:08:45,664 - __main__ - INFO - Deleted message for https://www.apartments.com/winter-street-apartments-8-boston-ma/dqcbfnk/
2025-08-28 01:11:42,463 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/ with status: Success
2025-08-28 01:11:42,784 - __main__ - INFO - Scrape OK: https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/ — persisting to DB
2025-08-28 01:11:42,787 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 01:11:43,274 - root - INFO - Inserting new property: 1700 Dorchester Ave
2025-08-28 01:11:43,505 - root - ERROR - Error saving property https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/ to database: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 11, 4... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO property (title, property_link, address, listing_verification, property_reviews, price, year_built, street, city, state, zip_code, validation_status, property_type, lease_option, timestamp) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::INTEGER, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::TIMESTAMP WITHOUT TIME ZONE) RETURNING property.id]
[parameters: ('1700 Dorchester Ave', 'https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/', 'Boston, MA, 02122', 'N/A', 0, None, 2022.0, 'N/A', 'Boston', 'MA', '02122', 'Success', 'Apartment', None, datetime.datetime(2025, 8, 27, 22, 11, 42, 804464, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/datetime.pyx", line 152, in asyncpg.pgproto.pgproto.timestamp_encode
TypeError: can't subtract offset-naive and offset-aware datetimes

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 11, 4... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 11, 4... (can't subtract offset-naive and offset-aware datetimes)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\database_ops\db_ops.py", line 154, in save_scraped_data_to_db
    await session.flush()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 801, in flush
    await greenlet_spawn(self.sync_session.flush, objects=objects)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
        statement,
        params,
        execution_options=execution_options,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1413, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1840, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1980, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $15: datetime.datetime(2025, 8, 27, 22, 11, 4... (can't subtract offset-naive and offset-aware datetimes)
[SQL: INSERT INTO property (title, property_link, address, listing_verification, property_reviews, price, year_built, street, city, state, zip_code, validation_status, property_type, lease_option, timestamp) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::INTEGER, $8::VARCHAR, $9::VARCHAR, $10::VARCHAR, $11::VARCHAR, $12::VARCHAR, $13::VARCHAR, $14::VARCHAR, $15::TIMESTAMP WITHOUT TIME ZONE) RETURNING property.id]
[parameters: ('1700 Dorchester Ave', 'https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/', 'Boston, MA, 02122', 'N/A', 0, None, 2022.0, 'N/A', 'Boston', 'MA', '02122', 'Success', 'Apartment', None, datetime.datetime(2025, 8, 27, 22, 11, 42, 804464, tzinfo=datetime.timezone.utc))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-08-28 01:11:43,598 - __main__ - INFO - Persisted.
2025-08-28 01:11:44,672 - __main__ - INFO - Deleted message for https://www.apartments.com/1700-dorchester-ave-boston-ma/z4k1whx/
2025-08-28 01:12:57,812 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 01:12:58,025 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 01:12:58,105 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/ reason=Failed: Exception
2025-08-28 01:12:58,135 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-28 01:12:58,725 - __main__ - INFO - Consumer process exited.
2025-08-28 01:17:13,195 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 01:17:30,049 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 01:17:34,239 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 01:17:34,258 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-28 01:17:38,530 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/
2025-08-28 01:17:38,536 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/
2025-08-28 01:17:40,538 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/
2025-08-28 01:17:40,540 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/
2025-08-28 01:17:41,003 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/
2025-08-28 01:17:41,003 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/
2025-08-28 01:17:42,497 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/
2025-08-28 01:17:42,498 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/
2025-08-28 01:17:44,777 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/
2025-08-28 01:17:44,778 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/
2025-08-28 01:17:51,744 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/
2025-08-28 01:17:51,901 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/
2025-08-28 01:17:51,907 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/
2025-08-28 01:17:51,930 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/
2025-08-28 01:17:52,453 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/
2025-08-28 01:17:53,912 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:17:53,913 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/ with status: Failed: Critical Data Missing
2025-08-28 01:17:53,917 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:17:53,917 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/ with status: Failed: Critical Data Missing
2025-08-28 01:17:53,920 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:17:53,921 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/15-dana-ave-boston-ma/008mms1/ with status: Failed: Critical Data Missing
2025-08-28 01:17:53,924 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:17:53,924 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/ with status: Failed: Critical Data Missing
2025-08-28 01:17:54,234 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/160-chestnut-hill-ave-boston-ma/es2p68q/ reason=Failed: Critical Data Missing
2025-08-28 01:17:54,414 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/23-ware-st-cambridge-ma-unit-1/5xddpsq/ reason=Failed: Critical Data Missing
2025-08-28 01:17:54,428 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/15-dana-ave-boston-ma/008mms1/ reason=Failed: Critical Data Missing
2025-08-28 01:17:54,540 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/163-newbury-st-boston-ma/w0yv44h/ reason=Failed: Critical Data Missing
2025-08-28 01:17:57,497 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/
2025-08-28 01:17:57,498 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/
2025-08-28 01:17:57,510 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-28 01:17:57,511 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-28 01:17:57,522 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/
2025-08-28 01:17:57,522 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/
2025-08-28 01:17:57,574 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/
2025-08-28 01:17:57,574 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/
2025-08-28 01:18:01,699 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/
2025-08-28 01:18:02,371 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/
2025-08-28 01:18:04,096 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/
2025-08-28 01:18:04,581 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:18:04,582 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ with status: Failed: Critical Data Missing
2025-08-28 01:18:04,588 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:18:04,589 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/ with status: Failed: Critical Data Missing
2025-08-28 01:18:04,926 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/509-beacon-st-boston-ma/4w55dll/ reason=Failed: Critical Data Missing
2025-08-28 01:18:04,950 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/135-nonantum-st-boston-ma-unit-2/yev8zmr/ reason=Failed: Critical Data Missing
2025-08-28 01:18:05,859 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/
2025-08-28 01:18:07,406 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/
2025-08-28 01:18:07,406 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/
2025-08-28 01:18:12,143 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/
2025-08-28 01:19:19,912 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/ with status: Success
2025-08-28 01:19:19,925 - __main__ - INFO - Scrape OK: https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/ — persisting to DB
2025-08-28 01:19:19,926 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 01:19:27,905 - root - INFO - Inserting new property: Canterbury Place
2025-08-28 01:19:28,680 - root - INFO - Successfully processed and committed property: https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/
2025-08-28 01:19:28,682 - __main__ - INFO - Persisted.
2025-08-28 01:19:29,617 - __main__ - INFO - Deleted message for https://www.apartments.com/canterbury-place-roslindale-ma/dpgxcyk/
2025-08-28 01:26:11,239 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 01:26:11,378 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 01:26:11,405 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/viv-boston-dorchester-ma/xg5qpcp/ reason=Failed: Exception
2025-08-28 01:26:11,410 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 01:26:11,419 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/ reason=Failed: Exception
2025-08-28 01:26:11,425 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 01:26:11,433 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/brandywyne-village-east-boston-ma/n2mp44m/ reason=Failed: Exception
2025-08-28 01:26:11,439 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-28 01:26:11,523 - __main__ - INFO - Consumer process exited.
2025-08-28 01:26:51,476 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 01:27:00,878 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 01:27:03,677 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 01:27:03,683 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-28 01:27:08,975 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 01:27:08,976 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 01:27:09,604 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/
2025-08-28 01:27:09,605 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/
2025-08-28 01:27:11,274 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/
2025-08-28 01:27:11,274 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/
2025-08-28 01:27:14,162 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/
2025-08-28 01:27:14,162 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/
2025-08-28 01:27:14,170 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/
2025-08-28 01:27:14,170 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/
2025-08-28 01:27:22,088 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 01:27:24,055 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:27:24,056 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/ with status: Failed: Critical Data Missing
2025-08-28 01:27:24,172 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/ reason=Failed: Critical Data Missing
2025-08-28 01:27:26,516 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 01:27:26,516 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 01:27:36,606 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/
2025-08-28 01:27:36,675 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/
2025-08-28 01:27:36,691 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/
2025-08-28 01:27:37,029 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/
2025-08-28 01:27:38,627 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:27:38,628 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/ with status: Failed: Critical Data Missing
2025-08-28 01:27:38,632 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:27:38,633 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/ with status: Failed: Critical Data Missing
2025-08-28 01:27:38,784 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:27:38,785 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/ with status: Failed: Critical Data Missing
2025-08-28 01:27:38,790 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:27:38,790 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/ with status: Failed: Critical Data Missing
2025-08-28 01:27:40,068 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/ reason=Failed: Critical Data Missing
2025-08-28 01:27:40,303 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/ reason=Failed: Critical Data Missing
2025-08-28 01:27:40,437 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/ reason=Failed: Critical Data Missing
2025-08-28 01:27:40,449 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/ reason=Failed: Critical Data Missing
2025-08-28 01:27:46,051 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/
2025-08-28 01:27:46,052 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/
2025-08-28 01:27:46,133 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 01:27:46,133 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 01:27:46,180 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/
2025-08-28 01:27:46,181 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/
2025-08-28 01:27:46,262 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/
2025-08-28 01:27:47,746 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/
2025-08-28 01:28:14,310 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/
2025-08-28 01:28:14,425 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/
2025-08-28 01:28:14,631 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/
2025-08-28 01:28:15,364 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 01:28:16,207 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:28:16,208 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/ with status: Failed: Critical Data Missing
2025-08-28 01:28:16,217 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/ reason=Failed: Critical Data Missing
2025-08-28 01:28:16,314 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:28:16,315 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/ with status: Failed: Critical Data Missing
2025-08-28 01:28:16,416 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/ reason=Failed: Critical Data Missing
2025-08-28 01:28:16,746 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 01:28:16,746 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/ with status: Failed: Critical Data Missing
2025-08-28 01:28:17,044 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/ reason=Failed: Critical Data Missing
2025-08-28 01:28:24,172 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 01:57:44,421 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 01:57:44,535 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/the-smith-boston-ma/l5tjjne/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 01:57:44,563 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/the-smith-boston-ma/l5tjjne/ reason=Failed: Exception
2025-08-28 01:57:44,571 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 01:57:44,579 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/ reason=Failed: Exception
2025-08-28 01:57:44,585 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-28 01:57:46,284 - __main__ - INFO - Consumer process exited.
2025-08-28 01:58:02,649 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 01:58:14,164 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 01:58:17,003 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 01:58:17,014 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=5 long_poll=20s
2025-08-28 01:58:20,198 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/one-newport-quincy-ma/dl1smdh/
2025-08-28 01:58:20,198 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/one-newport-quincy-ma/dl1smdh/
2025-08-28 01:58:21,237 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/clippership-apartments-on-the-wharf-boston-ma/fe6wytr/
2025-08-28 01:58:21,237 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/clippership-apartments-on-the-wharf-boston-ma/fe6wytr/
2025-08-28 01:58:26,566 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/115-mt-auburn-fully-furnished-cambridge-ma/ejdvh8n/
2025-08-28 01:58:26,566 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/115-mt-auburn-fully-furnished-cambridge-ma/ejdvh8n/
2025-08-28 01:58:28,499 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-28 01:58:28,500 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-28 01:58:31,118 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/vera-brighton-ma/y09g4wv/
2025-08-28 01:58:31,118 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/vera-brighton-ma/y09g4wv/
2025-08-28 01:58:34,345 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/one-newport-quincy-ma/dl1smdh/
2025-08-28 01:58:40,076 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/clippership-apartments-on-the-wharf-boston-ma/fe6wytr/
2025-08-28 01:58:40,319 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/115-mt-auburn-fully-furnished-cambridge-ma/ejdvh8n/
2025-08-28 01:58:49,026 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/vera-brighton-ma/y09g4wv/
2025-08-28 01:59:30,515 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-28 01:59:48,752 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-andi-boston-ma/v5nq3ng/
2025-08-28 02:02:52,666 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 02:02:53,160 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/one-newport-quincy-ma/dl1smdh/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:02:53,340 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/one-newport-quincy-ma/dl1smdh/ reason=Failed: Exception
2025-08-28 02:02:53,393 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/115-mt-auburn-fully-furnished-cambridge-ma/ejdvh8n/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:02:53,407 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/115-mt-auburn-fully-furnished-cambridge-ma/ejdvh8n/ reason=Failed: Exception
2025-08-28 02:02:53,416 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/the-andi-boston-ma/v5nq3ng/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:02:53,425 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/the-andi-boston-ma/v5nq3ng/ reason=Failed: Exception
2025-08-28 02:02:53,439 - __main__ - ERROR - Critical error processing url=https://www.apartments.com/one65-main-cambridge-ma/8f75162/: BrowserContext.new_page: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 75, in process_message
    scraped_data = await scraper.scrape_single_property_page(url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 102, in scrape_single_property_page
    page = await self.context.new_page()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 12791, in new_page
    return mapping.from_impl(await self._impl_obj.new_page())
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser_context.py", line 325, in new_page
    return from_channel(await self._channel.send("newPage"))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: BrowserContext.new_page: Target page, context or browser has been closed
2025-08-28 02:02:53,458 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/clippership-apartments-on-the-wharf-boston-ma/fe6wytr/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:02:53,462 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/clippership-apartments-on-the-wharf-boston-ma/fe6wytr/ reason=Failed: Exception
2025-08-28 02:02:53,471 - __main__ - ERROR - Critical error processing url=https://www.apartments.com/525-linc-allston-ma/2x035m8/: BrowserContext.new_page: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 75, in process_message
    scraped_data = await scraper.scrape_single_property_page(url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 102, in scrape_single_property_page
    page = await self.context.new_page()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 12791, in new_page
    return mapping.from_impl(await self._impl_obj.new_page())
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser_context.py", line 325, in new_page
    return from_channel(await self._channel.send("newPage"))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: BrowserContext.new_page: Target page, context or browser has been closed
2025-08-28 02:02:53,477 - __main__ - ERROR - Critical error processing url=https://www.apartments.com/133-seaport-blvd-boston-ma/cvdcqzg/: BrowserContext.new_page: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 75, in process_message
    scraped_data = await scraper.scrape_single_property_page(url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 102, in scrape_single_property_page
    page = await self.context.new_page()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 12791, in new_page
    return mapping.from_impl(await self._impl_obj.new_page())
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser_context.py", line 325, in new_page
    return from_channel(await self._channel.send("newPage"))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: BrowserContext.new_page: Target page, context or browser has been closed
2025-08-28 02:02:53,485 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/vera-brighton-ma/y09g4wv/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:02:53,492 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/vera-brighton-ma/y09g4wv/ reason=Failed: Exception
2025-08-28 02:02:53,498 - __main__ - ERROR - Critical error processing url=https://www.apartments.com/serenity-jamaica-plain-ma/5mls63n/: BrowserContext.new_page: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 75, in process_message
    scraped_data = await scraper.scrape_single_property_page(url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 102, in scrape_single_property_page
    page = await self.context.new_page()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 12791, in new_page
    return mapping.from_impl(await self._impl_obj.new_page())
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser_context.py", line 325, in new_page
    return from_channel(await self._channel.send("newPage"))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: BrowserContext.new_page: Target page, context or browser has been closed
2025-08-28 02:02:53,634 - __main__ - ERROR - Critical error processing url=https://www.apartments.com/26-worcester-square-boston-ma-unit-fl1-id938/c57kp7d/: BrowserContext.new_page: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 75, in process_message
    scraped_data = await scraper.scrape_single_property_page(url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 102, in scrape_single_property_page
    page = await self.context.new_page()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 12791, in new_page
    return mapping.from_impl(await self._impl_obj.new_page())
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser_context.py", line 325, in new_page
    return from_channel(await self._channel.send("newPage"))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: BrowserContext.new_page: Connection closed while reading from the driver
2025-08-28 02:02:53,654 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-28 02:02:53,815 - __main__ - CRITICAL - Unhandled critical error in main: Browser.close: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 198, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 190, in main
    async with ApartmentScraper(p) as scraper:
               ~~~~~~~~~~~~~~~~^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 49, in __aexit__
    await self.browser.close()
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 14223, in close
    return mapping.from_maybe_impl(await self._impl_obj.close(reason=reason))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 195, in close
    raise e
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser.py", line 192, in close
    await self._channel.send("close", {"reason": reason})
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Browser.close: Connection closed while reading from the driver
2025-08-28 02:03:13,080 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 02:03:21,020 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 02:03:24,052 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 02:03:24,060 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=10 long_poll=20s
2025-08-28 02:03:26,705 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/12-14-marcella-st-unit-2a-cambridge-ma-unit-2a/zgkqb4z/
2025-08-28 02:03:26,705 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/12-14-marcella-st-unit-2a-cambridge-ma-unit-2a/zgkqb4z/
2025-08-28 02:03:27,703 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/60-brainerd-rd-boston-ma-unit-fl2-id792/1hz3y34/
2025-08-28 02:03:27,704 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/60-brainerd-rd-boston-ma-unit-fl2-id792/1hz3y34/
2025-08-28 02:03:28,466 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/ink-block-boston-ma/b92qt39/
2025-08-28 02:03:28,466 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/ink-block-boston-ma/b92qt39/
2025-08-28 02:03:28,882 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/78-sawyer-ave-boston-ma-unit-3/ygqkcjv/
2025-08-28 02:03:28,882 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/78-sawyer-ave-boston-ma-unit-3/ygqkcjv/
2025-08-28 02:03:30,155 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/10-scottfield-rd-boston-ma-unit-22/xkxbhnq/
2025-08-28 02:03:30,156 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/10-scottfield-rd-boston-ma-unit-22/xkxbhnq/
2025-08-28 02:03:32,602 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/10-selkirk-rd-boston-ma-unit-2/gmx411y/
2025-08-28 02:03:32,602 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/10-selkirk-rd-boston-ma-unit-2/gmx411y/
2025-08-28 02:03:33,714 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/12-14-marcella-st-unit-2a-cambridge-ma-unit-2a/zgkqb4z/
2025-08-28 02:03:36,534 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:03:36,535 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/12-14-marcella-st-unit-2a-cambridge-ma-unit-2a/zgkqb4z/ with status: Failed: Critical Data Missing
2025-08-28 02:03:36,595 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/parmelee-court-boston-ma/hwnd553/
2025-08-28 02:03:36,596 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/parmelee-court-boston-ma/hwnd553/
2025-08-28 02:03:37,334 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/12-14-marcella-st-unit-2a-cambridge-ma-unit-2a/zgkqb4z/ reason=Failed: Critical Data Missing
2025-08-28 02:03:37,870 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/78-sawyer-ave-boston-ma-unit-3/ygqkcjv/
2025-08-28 02:03:38,760 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/38-newton-st-boston-ma/mxbpxmk/
2025-08-28 02:03:38,760 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/38-newton-st-boston-ma/mxbpxmk/
2025-08-28 02:03:40,891 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/10-scottfield-rd-boston-ma-unit-22/xkxbhnq/
2025-08-28 02:03:41,159 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/ink-block-boston-ma/b92qt39/
2025-08-28 02:03:41,618 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:03:41,618 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/78-sawyer-ave-boston-ma-unit-3/ygqkcjv/ with status: Failed: Critical Data Missing
2025-08-28 02:03:42,526 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/78-sawyer-ave-boston-ma-unit-3/ygqkcjv/ reason=Failed: Critical Data Missing
2025-08-28 02:03:42,601 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:03:42,601 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/10-scottfield-rd-boston-ma-unit-22/xkxbhnq/ with status: Failed: Critical Data Missing
2025-08-28 02:03:44,983 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/10-scottfield-rd-boston-ma-unit-22/xkxbhnq/ reason=Failed: Critical Data Missing
2025-08-28 02:03:46,193 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/14-winter-st-boston-ma/5mg495q/
2025-08-28 02:03:46,193 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/14-winter-st-boston-ma/5mg495q/
2025-08-28 02:03:46,473 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/stony-brook-village-boston-ma/x54fysn/
2025-08-28 02:03:46,474 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/stony-brook-village-boston-ma/x54fysn/
2025-08-28 02:03:49,086 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/parmelee-court-boston-ma/hwnd553/
2025-08-28 02:03:49,120 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/38-newton-st-boston-ma/mxbpxmk/
2025-08-28 02:03:51,138 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:03:51,138 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/38-newton-st-boston-ma/mxbpxmk/ with status: Failed: Critical Data Missing
2025-08-28 02:03:52,059 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/38-newton-st-boston-ma/mxbpxmk/ reason=Failed: Critical Data Missing
2025-08-28 02:03:56,925 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/14-winter-st-boston-ma/5mg495q/
2025-08-28 02:03:59,666 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:03:59,666 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/14-winter-st-boston-ma/5mg495q/ with status: Failed: Critical Data Missing
2025-08-28 02:03:59,810 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/14-winter-st-boston-ma/5mg495q/ reason=Failed: Critical Data Missing
2025-08-28 02:04:18,216 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/10-selkirk-rd-boston-ma-unit-2/gmx411y/
2025-08-28 02:04:20,398 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/60-brainerd-rd-boston-ma-unit-fl2-id792/1hz3y34/
2025-08-28 02:04:20,567 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:04:20,568 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/10-selkirk-rd-boston-ma-unit-2/gmx411y/ with status: Failed: Critical Data Missing
2025-08-28 02:04:21,350 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/10-selkirk-rd-boston-ma-unit-2/gmx411y/ reason=Failed: Critical Data Missing
2025-08-28 02:04:21,817 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:04:21,817 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/60-brainerd-rd-boston-ma-unit-fl2-id792/1hz3y34/ with status: Failed: Critical Data Missing
2025-08-28 02:04:21,914 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/60-brainerd-rd-boston-ma-unit-fl2-id792/1hz3y34/ reason=Failed: Critical Data Missing
2025-08-28 02:04:24,432 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/stony-brook-village-boston-ma/x54fysn/
2025-08-28 02:05:49,094 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 02:05:49,252 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/stony-brook-village-boston-ma/x54fysn/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:05:49,271 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/stony-brook-village-boston-ma/x54fysn/ reason=Failed: Exception
2025-08-28 02:05:49,278 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/ink-block-boston-ma/b92qt39/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:05:49,285 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/ink-block-boston-ma/b92qt39/ reason=Failed: Exception
2025-08-28 02:05:49,292 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/parmelee-court-boston-ma/hwnd553/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:05:49,300 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/parmelee-court-boston-ma/hwnd553/ reason=Failed: Exception
2025-08-28 02:05:49,306 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-28 02:05:51,003 - __main__ - INFO - Consumer process exited.
2025-08-28 02:07:20,217 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 02:07:28,277 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 02:07:30,826 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 02:07:30,833 - __main__ - INFO - SQS consumer started — batch_size=4 concurrency=2 long_poll=5s
2025-08-28 02:07:33,992 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 02:07:33,992 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 02:07:35,898 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/
2025-08-28 02:07:35,899 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/
2025-08-28 02:07:40,972 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/
2025-08-28 02:07:42,517 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:07:42,517 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/ with status: Failed: Critical Data Missing
2025-08-28 02:07:42,545 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/ reason=Failed: Critical Data Missing
2025-08-28 02:07:45,482 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 02:07:45,482 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 02:07:59,026 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 02:08:01,112 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 02:09:31,126 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 02:09:35,905 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:09:35,911 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/ reason=Failed: Exception
2025-08-28 02:09:35,922 - data_extraction.scraper - ERROR - Error scraping URL https://www.apartments.com/30-dalton-boston-ma/syhm505/: Locator.count: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 108, in scrape_single_property_page
    scraped_data = await extractor.extract_data()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 74, in extract_data
    data['pricing_and_floor_plans'] = await self._extract_floor_plans()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 114, in _extract_floor_plans
    'sqft': await self._extract_sqft(unit_card),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\data_extractor.py", line 128, in _extract_sqft
    for j in range(await details_spans.count()):
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 16642, in count
    return mapping.from_maybe_impl(await self._impl_obj.count())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_locator.py", line 398, in count
    return await self._frame._query_count(self._selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_frame.py", line 128, in _query_count
    return await self._channel.send("queryCount", {"selector": selector})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: Locator.count: Target page, context or browser has been closed
2025-08-28 02:09:35,930 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/30-dalton-boston-ma/syhm505/ reason=Failed: Exception
2025-08-28 02:09:35,937 - __main__ - ERROR - Critical error processing url=https://www.apartments.com/longwood-row-boston-ma/kp71r5c/: BrowserContext.new_page: Target page, context or browser has been closed
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 75, in process_message
    scraped_data = await scraper.scrape_single_property_page(url)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\scraper.py", line 102, in scrape_single_property_page
    page = await self.context.new_page()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_generated.py", line 12791, in new_page
    return mapping.from_impl(await self._impl_obj.new_page())
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_browser_context.py", line 325, in new_page
    return from_channel(await self._channel.send("newPage"))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.TargetClosedError: BrowserContext.new_page: Target page, context or browser has been closed
2025-08-28 02:09:35,944 - __main__ - INFO - Stop signal received — exiting polling loop.
2025-08-28 02:09:39,573 - __main__ - INFO - Consumer process exited.
2025-08-28 02:09:49,373 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 02:09:52,749 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 02:09:54,785 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 02:09:54,802 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=10 long_poll=5s
2025-08-28 02:09:58,847 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/
2025-08-28 02:09:58,848 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/
2025-08-28 02:10:00,964 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/
2025-08-28 02:10:00,964 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/
2025-08-28 02:10:02,164 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 02:10:03,746 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 02:10:04,464 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/radius-brighton-ma/4vmy67l/
2025-08-28 02:10:04,464 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/radius-brighton-ma/4vmy67l/
2025-08-28 02:10:07,030 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/
2025-08-28 02:10:07,031 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/
2025-08-28 02:10:09,822 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/
2025-08-28 02:10:09,822 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/
2025-08-28 02:10:09,933 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 02:10:09,933 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 02:10:09,946 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 02:10:09,946 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 02:10:11,749 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/
2025-08-28 02:10:14,601 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 02:10:14,822 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/
2025-08-28 02:10:15,664 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 02:10:15,664 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 02:10:15,700 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:10:15,701 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/ with status: Failed: Critical Data Missing
2025-08-28 02:10:17,833 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/radius-brighton-ma/4vmy67l/
2025-08-28 02:10:19,019 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/ reason=Failed: Critical Data Missing
2025-08-28 02:10:19,494 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/
2025-08-28 02:10:20,615 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/
2025-08-28 02:10:20,615 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/
2025-08-28 02:10:25,145 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 02:10:27,339 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 02:10:28,871 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/
2025-08-28 02:10:29,175 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:10:29,176 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/ with status: Failed: Critical Data Missing
2025-08-28 02:10:29,185 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/ reason=Failed: Critical Data Missing
2025-08-28 02:10:29,359 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:10:29,359 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/ with status: Failed: Critical Data Missing
2025-08-28 02:10:30,951 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/ reason=Failed: Critical Data Missing
2025-08-28 02:10:32,589 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 02:10:37,552 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:10:37,552 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/ with status: Failed: Critical Data Missing
2025-08-28 02:10:37,923 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/ reason=Failed: Critical Data Missing
2025-08-28 02:10:38,994 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/
2025-08-28 02:26:55,121 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/radius-brighton-ma/4vmy67l/ with status: Success
2025-08-28 02:26:56,122 - __main__ - INFO - Scrape OK: https://www.apartments.com/radius-brighton-ma/4vmy67l/ — persisting to DB
2025-08-28 02:26:56,125 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 02:27:04,581 - root - INFO - Inserting new property: Radius
2025-08-28 02:27:06,371 - root - INFO - Successfully processed and committed property: https://www.apartments.com/radius-brighton-ma/4vmy67l/
2025-08-28 02:27:06,373 - __main__ - INFO - Persisted.
2025-08-28 02:27:09,090 - __main__ - INFO - Deleted message for https://www.apartments.com/radius-brighton-ma/4vmy67l/
2025-08-28 02:29:01,092 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/ with status: Success
2025-08-28 02:29:01,099 - __main__ - INFO - Scrape OK: https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/ — persisting to DB
2025-08-28 02:29:01,099 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 02:29:01,545 - root - INFO - Updating existing property: Mezzo Design Lofts
2025-08-28 02:29:04,938 - root - INFO - Successfully processed and committed property: https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/
2025-08-28 02:29:04,939 - __main__ - INFO - Persisted.
2025-08-28 02:29:05,833 - __main__ - INFO - Deleted message for https://www.apartments.com/mezzo-design-lofts-charlestown-ma/gfmfq9y/
2025-08-28 02:31:02,898 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/ with status: Success
2025-08-28 02:31:02,910 - __main__ - INFO - Scrape OK: https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/ — persisting to DB
2025-08-28 02:31:02,910 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 02:31:03,354 - root - INFO - Inserting new property: Flats on D
2025-08-28 02:31:04,294 - root - INFO - Successfully processed and committed property: https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/
2025-08-28 02:31:05,277 - __main__ - INFO - Persisted.
2025-08-28 02:31:06,334 - __main__ - INFO - Deleted message for https://www.apartments.com/flats-on-d-boston-ma/sxf2kq6/
2025-08-28 02:32:49,822 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/ with status: Success
2025-08-28 02:32:49,829 - __main__ - INFO - Scrape OK: https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/ — persisting to DB
2025-08-28 02:32:49,829 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 02:32:50,293 - root - INFO - Inserting new property: West Square Apartments
2025-08-28 02:32:51,305 - root - INFO - Successfully processed and committed property: https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/
2025-08-28 02:32:51,306 - __main__ - INFO - Persisted.
2025-08-28 02:32:52,238 - __main__ - INFO - Deleted message for https://www.apartments.com/west-square-apartments-boston-ma/k77v7xc/
2025-08-28 02:41:12,306 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/ with status: Success
2025-08-28 02:41:12,380 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/ — persisting to DB
2025-08-28 02:41:12,381 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 02:41:12,826 - root - INFO - Inserting new property: The Batch Yard
2025-08-28 02:41:13,755 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/
2025-08-28 02:41:13,756 - __main__ - INFO - Persisted.
2025-08-28 02:41:14,648 - __main__ - INFO - Deleted message for https://www.apartments.com/the-batch-yard-everett-ma/1d7fd95/
2025-08-28 02:41:33,530 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/ with status: Success
2025-08-28 02:41:33,537 - __main__ - INFO - Scrape OK: https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/ — persisting to DB
2025-08-28 02:41:33,538 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 02:41:33,992 - root - INFO - Inserting new property: CHR Brookline - Coolidge Corner Communities
2025-08-28 02:41:34,688 - root - INFO - Successfully processed and committed property: https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/
2025-08-28 02:41:34,690 - __main__ - INFO - Persisted.
2025-08-28 02:41:35,691 - __main__ - INFO - Deleted message for https://www.apartments.com/chr-brookline-coolidge-corner-communities-brookline-ma/4w3fxqj/
2025-08-28 02:41:46,554 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/
2025-08-28 02:41:46,555 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/
2025-08-28 02:41:46,589 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/
2025-08-28 02:41:46,590 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/
2025-08-28 02:41:46,601 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 02:41:46,602 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 02:41:46,610 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/
2025-08-28 02:41:46,610 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/
2025-08-28 02:41:46,616 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/
2025-08-28 02:41:46,617 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/
2025-08-28 02:41:46,623 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/
2025-08-28 02:41:46,623 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/
2025-08-28 02:41:46,630 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/
2025-08-28 02:41:46,631 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/
2025-08-28 02:41:46,636 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 02:41:46,637 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 02:41:46,642 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 02:41:46,643 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 02:41:46,648 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/
2025-08-28 02:41:46,648 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/
2025-08-28 02:41:50,932 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/
2025-08-28 02:41:52,768 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/
2025-08-28 02:42:00,938 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:00,938 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/ with status: Failed: Critical Data Missing
2025-08-28 02:42:01,962 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 02:42:03,688 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:03,688 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/ with status: Failed: Critical Data Missing
2025-08-28 02:42:03,734 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/
2025-08-28 02:42:05,614 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/13-spalding-st-boston-ma/qtked0w/ reason=Failed: Critical Data Missing
2025-08-28 02:42:06,694 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/
2025-08-28 02:42:07,033 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/836-huntington-ave-boston-ma/b5tz73b/ reason=Failed: Critical Data Missing
2025-08-28 02:42:07,180 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/
2025-08-28 02:42:07,308 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 02:42:08,018 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:08,018 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/ with status: Failed: Critical Data Missing
2025-08-28 02:42:08,341 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:08,341 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/ with status: Failed: Critical Data Missing
2025-08-28 02:42:08,347 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/9-wave-ave-boston-ma/dg5d73k/ reason=Failed: Critical Data Missing
2025-08-28 02:42:08,529 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:08,530 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/ with status: Failed: Critical Data Missing
2025-08-28 02:42:08,760 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/172-n-beacon-st-boston-ma-unit-12/nrdj4sp/ reason=Failed: Critical Data Missing
2025-08-28 02:42:08,905 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/332-jamaicaway-boston-ma-unit-404/02fjn43/ reason=Failed: Critical Data Missing
2025-08-28 02:42:09,254 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/
2025-08-28 02:42:09,264 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/
2025-08-28 02:42:11,102 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:11,102 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/ with status: Failed: Critical Data Missing
2025-08-28 02:42:11,110 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/50-putnam-st-boston-ma/1zk6yc4/ reason=Failed: Critical Data Missing
2025-08-28 02:42:11,368 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:11,368 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/ with status: Failed: Critical Data Missing
2025-08-28 02:42:11,443 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/3-nira-ave-boston-ma/cvc3w5d/ reason=Failed: Critical Data Missing
2025-08-28 02:42:49,311 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 02:42:55,947 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/
2025-08-28 02:42:57,451 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 02:42:57,451 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/ with status: Failed: Critical Data Missing
2025-08-28 02:42:57,465 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/51-brookline-ave-boston-ma/znqg2gx/ reason=Failed: Critical Data Missing
2025-08-28 03:12:45,309 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/ with status: Success
2025-08-28 03:12:45,830 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-smith-boston-ma/l5tjjne/ with status: Success
2025-08-28 03:12:45,868 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/ — persisting to DB
2025-08-28 03:12:45,877 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:12:46,129 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-smith-boston-ma/l5tjjne/ — persisting to DB
2025-08-28 03:12:46,129 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:12:46,332 - root - INFO - Inserting new property: The Benjamin Seaport Residences
2025-08-28 03:12:47,194 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 03:12:47,195 - __main__ - INFO - Persisted.
2025-08-28 03:12:49,677 - __main__ - INFO - Deleted message for https://www.apartments.com/the-benjamin-seaport-residences-boston-ma/7n1q0pw/
2025-08-28 03:12:51,399 - root - INFO - Inserting new property: The Smith
2025-08-28 03:12:52,548 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 03:12:52,550 - __main__ - INFO - Persisted.
2025-08-28 03:12:52,795 - __main__ - INFO - Deleted message for https://www.apartments.com/the-smith-boston-ma/l5tjjne/
2025-08-28 03:12:57,254 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 03:12:57,254 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 03:13:01,043 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/10-new-st-boston-ma-unit-fl9-id1150/m2ylc1j/
2025-08-28 03:13:01,044 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/10-new-st-boston-ma-unit-fl9-id1150/m2ylc1j/
2025-08-28 03:13:01,062 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/
2025-08-28 03:13:01,063 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/
2025-08-28 03:13:01,112 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/25-haskell-st-boston-ma/e551bym/
2025-08-28 03:13:01,112 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/25-haskell-st-boston-ma/e551bym/
2025-08-28 03:13:01,119 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/51-brock-st-boston-ma/wmz4tdk/
2025-08-28 03:13:01,119 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/51-brock-st-boston-ma/wmz4tdk/
2025-08-28 03:13:01,196 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 03:13:01,197 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 03:13:01,429 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-28 03:13:01,430 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-28 03:13:01,481 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/461-arborway-boston-ma/83q2873/
2025-08-28 03:13:01,482 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/461-arborway-boston-ma/83q2873/
2025-08-28 03:13:01,912 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/280-western-allston-ma/4mrnm9h/
2025-08-28 03:13:01,913 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/280-western-allston-ma/4mrnm9h/
2025-08-28 03:13:01,919 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/38-allston-st-boston-ma-unit-2/qtfn9ny/
2025-08-28 03:13:01,919 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/38-allston-st-boston-ma-unit-2/qtfn9ny/
2025-08-28 03:13:23,558 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/25-haskell-st-boston-ma/e551bym/
2025-08-28 03:13:23,796 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/51-brock-st-boston-ma/wmz4tdk/
2025-08-28 03:13:26,229 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/
2025-08-28 03:13:28,211 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:13:28,211 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/25-haskell-st-boston-ma/e551bym/ with status: Failed: Critical Data Missing
2025-08-28 03:13:28,230 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:13:28,231 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/51-brock-st-boston-ma/wmz4tdk/ with status: Failed: Critical Data Missing
2025-08-28 03:13:29,920 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:13:29,920 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/ with status: Failed: Critical Data Missing
2025-08-28 03:13:30,094 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/25-haskell-st-boston-ma/e551bym/ reason=Failed: Critical Data Missing
2025-08-28 03:13:30,568 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/51-brock-st-boston-ma/wmz4tdk/ reason=Failed: Critical Data Missing
2025-08-28 03:13:31,400 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1419-commonwealth-ave-boston-ma-unit-102/ltkkq3g/ reason=Failed: Critical Data Missing
2025-08-28 03:13:47,449 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 03:13:52,260 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 03:13:52,693 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/461-arborway-boston-ma/83q2873/
2025-08-28 03:13:52,886 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/280-western-allston-ma/4mrnm9h/
2025-08-28 03:13:52,904 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/10-new-st-boston-ma-unit-fl9-id1150/m2ylc1j/
2025-08-28 03:13:52,910 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/38-allston-st-boston-ma-unit-2/qtfn9ny/
2025-08-28 03:13:53,952 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-28 03:13:58,942 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:13:58,942 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/461-arborway-boston-ma/83q2873/ with status: Failed: Critical Data Missing
2025-08-28 03:14:01,743 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:14:01,743 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/10-new-st-boston-ma-unit-fl9-id1150/m2ylc1j/ with status: Failed: Critical Data Missing
2025-08-28 03:14:01,778 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:14:01,779 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/38-allston-st-boston-ma-unit-2/qtfn9ny/ with status: Failed: Critical Data Missing
2025-08-28 03:14:02,182 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/461-arborway-boston-ma/83q2873/ reason=Failed: Critical Data Missing
2025-08-28 03:14:02,591 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/10-new-st-boston-ma-unit-fl9-id1150/m2ylc1j/ reason=Failed: Critical Data Missing
2025-08-28 03:14:02,767 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/38-allston-st-boston-ma-unit-2/qtfn9ny/ reason=Failed: Critical Data Missing
2025-08-28 03:16:04,905 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/ with status: Success
2025-08-28 03:16:04,915 - __main__ - INFO - Scrape OK: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/ — persisting to DB
2025-08-28 03:16:04,915 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:16:05,358 - root - INFO - Inserting new property: The Lofts at Atlantic Wharf
2025-08-28 03:16:06,249 - root - INFO - Successfully processed and committed property: https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 03:16:06,250 - __main__ - INFO - Persisted.
2025-08-28 03:16:07,181 - __main__ - INFO - Deleted message for https://www.apartments.com/the-lofts-at-atlantic-wharf-boston-ma/entsm9q/
2025-08-28 03:24:39,425 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/ with status: Success
2025-08-28 03:24:39,431 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/280-western-allston-ma/4mrnm9h/ with status: Success
2025-08-28 03:24:39,437 - __main__ - INFO - Scrape OK: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/ — persisting to DB
2025-08-28 03:24:39,437 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:24:39,669 - __main__ - INFO - Scrape OK: https://www.apartments.com/280-western-allston-ma/4mrnm9h/ — persisting to DB
2025-08-28 03:24:39,669 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:24:39,883 - root - INFO - Updating existing property: Longwood Row
2025-08-28 03:24:40,112 - root - INFO - Inserting new property: 280 Western
2025-08-28 03:24:41,244 - root - INFO - Successfully processed and committed property: https://www.apartments.com/280-western-allston-ma/4mrnm9h/
2025-08-28 03:24:41,244 - __main__ - INFO - Persisted.
2025-08-28 03:24:41,468 - root - INFO - Successfully processed and committed property: https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-28 03:24:41,469 - __main__ - INFO - Persisted.
2025-08-28 03:24:42,175 - __main__ - INFO - Deleted message for https://www.apartments.com/280-western-allston-ma/4mrnm9h/
2025-08-28 03:24:42,484 - __main__ - INFO - Deleted message for https://www.apartments.com/longwood-row-boston-ma/kp71r5c/
2025-08-28 03:44:47,143 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/30-dalton-boston-ma/syhm505/ with status: Success
2025-08-28 03:44:47,150 - __main__ - INFO - Scrape OK: https://www.apartments.com/30-dalton-boston-ma/syhm505/ — persisting to DB
2025-08-28 03:44:47,150 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:44:47,593 - root - INFO - Updating existing property: 30 Dalton
2025-08-28 03:44:48,731 - root - INFO - Successfully processed and committed property: https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 03:44:48,733 - __main__ - INFO - Persisted.
2025-08-28 03:44:49,953 - __main__ - INFO - Deleted message for https://www.apartments.com/30-dalton-boston-ma/syhm505/
2025-08-28 03:45:00,952 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 03:45:00,952 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 03:45:01,675 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 03:45:01,676 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 03:45:01,690 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 03:45:01,691 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 03:45:01,706 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 03:45:01,706 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 03:45:01,712 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 03:45:01,713 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 03:45:01,746 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/peridot-allston-ma/h4c2lc2/
2025-08-28 03:45:01,747 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/peridot-allston-ma/h4c2lc2/
2025-08-28 03:45:01,762 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/
2025-08-28 03:45:01,763 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/
2025-08-28 03:45:01,769 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 03:45:01,769 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 03:45:01,774 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/
2025-08-28 03:45:01,774 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/
2025-08-28 03:45:01,782 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 03:45:01,783 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 03:45:10,654 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/
2025-08-28 03:45:11,362 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 03:45:15,699 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 03:45:17,566 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:45:17,567 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/ with status: Failed: Critical Data Missing
2025-08-28 03:45:19,469 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 03:45:19,623 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/
2025-08-28 03:45:20,076 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 03:45:20,802 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/ reason=Failed: Critical Data Missing
2025-08-28 03:45:21,133 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:45:21,133 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/ with status: Failed: Critical Data Missing
2025-08-28 03:45:21,517 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/ reason=Failed: Critical Data Missing
2025-08-28 03:45:21,575 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:45:21,576 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/ with status: Failed: Critical Data Missing
2025-08-28 03:45:21,967 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/ reason=Failed: Critical Data Missing
2025-08-28 03:45:22,310 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 03:45:22,320 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 03:45:22,325 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 03:45:23,492 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:45:23,493 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/ with status: Failed: Critical Data Missing
2025-08-28 03:45:23,503 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/ reason=Failed: Critical Data Missing
2025-08-28 03:45:23,571 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 03:45:23,572 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/ with status: Failed: Critical Data Missing
2025-08-28 03:45:23,838 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/ reason=Failed: Critical Data Missing
2025-08-28 03:45:44,419 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/peridot-allston-ma/h4c2lc2/
2025-08-28 03:46:26,473 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/ with status: Success
2025-08-28 03:46:27,695 - __main__ - INFO - Scrape OK: https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/ — persisting to DB
2025-08-28 03:46:27,696 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:46:28,144 - root - INFO - Inserting new property: Chapman Arms
2025-08-28 03:46:28,592 - root - INFO - Successfully processed and committed property: https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/
2025-08-28 03:46:28,593 - __main__ - INFO - Persisted.
2025-08-28 03:46:29,559 - __main__ - INFO - Deleted message for https://www.apartments.com/chapman-arms-cambridge-ma/fwzq7fs/
2025-08-28 03:49:29,635 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/ with status: Success
2025-08-28 03:49:29,641 - __main__ - INFO - Scrape OK: https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/ — persisting to DB
2025-08-28 03:49:29,641 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:49:30,085 - root - INFO - Updating existing property: MBH Apartments
2025-08-28 03:49:31,221 - root - INFO - Successfully processed and committed property: https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/
2025-08-28 03:49:31,223 - __main__ - INFO - Persisted.
2025-08-28 03:49:32,396 - __main__ - INFO - Deleted message for https://www.apartments.com/mbh-apartments-boston-ma/ss1ke26/
2025-08-28 03:58:52,415 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/peridot-allston-ma/h4c2lc2/ with status: Success
2025-08-28 03:58:52,423 - __main__ - INFO - Scrape OK: https://www.apartments.com/peridot-allston-ma/h4c2lc2/ — persisting to DB
2025-08-28 03:58:52,423 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 03:58:52,865 - root - INFO - Updating existing property: Peridot
2025-08-28 03:58:57,148 - root - ERROR - Integrity Error for https://www.apartments.com/peridot-allston-ma/h4c2lc2/: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column "property_reviews" of relation "property" violates not-null constraint
DETAIL:  Failing row contains (134, Peridot, https://www.apartments.com/peridot-allston-ma/h4c2lc2/, Allston, MA, 02134, N/A, null, null, 2021, N/A, Allston, MA, 02134, Success, Apartment, ["12 mo"], 2025-08-28 00:58:52.423521).
[SQL: UPDATE property SET address=$1::VARCHAR, property_reviews=$2::FLOAT, street=$3::VARCHAR, city=$4::VARCHAR, lease_option=$5::VARCHAR, timestamp=$6::TIMESTAMP WITHOUT TIME ZONE WHERE property.id = $7::INTEGER]
[parameters: ('Allston, MA, 02134', None, 'N/A', 'Allston', '["12 mo"]', datetime.datetime(2025, 8, 28, 0, 58, 52, 423521), 134)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-08-28 03:58:57,153 - __main__ - INFO - Persisted.
2025-08-28 03:58:59,740 - __main__ - INFO - Deleted message for https://www.apartments.com/peridot-allston-ma/h4c2lc2/
2025-08-28 04:04:39,966 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/ with status: Success
2025-08-28 04:04:41,337 - __main__ - INFO - Scrape OK: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/ — persisting to DB
2025-08-28 04:04:41,338 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 04:04:41,785 - root - INFO - Inserting new property: 886-896 Huntington Avenue
2025-08-28 04:04:42,491 - root - INFO - Successfully processed and committed property: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 04:04:42,494 - __main__ - INFO - Persisted.
2025-08-28 04:04:43,503 - __main__ - INFO - Deleted message for https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 11:52:04,244 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 11:52:39,447 - __main__ - INFO - Received SIGTERM — initiating shutdown...
2025-08-28 11:52:39,450 - __main__ - CRITICAL - Unhandled critical error in main: Connection closed while reading from the driver
Traceback (most recent call last):
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 198, in <module>
    asyncio.run(main())
    ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 720, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\Real-Estate-Data-Pipeline\data_extraction\consumer.py", line 189, in main
    async with async_playwright() as p:
               ~~~~~~~~~~~~~~~~^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\async_api\_context_manager.py", line 46, in __aenter__
    playwright = AsyncPlaywright(next(iter(done)).result())
                                 ~~~~~~~~~~~~~~~~~~~~~~~^^
Exception: Connection closed while reading from the driver
2025-08-28 11:52:39,529 - asyncio - ERROR - Task exception was never retrieved
future: <Task finished name='Task-4' coro=<Connection.run.<locals>.init() done, defined at C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py:276> exception=Exception('Connection.init: Connection closed while reading from the driver')>
Traceback (most recent call last):
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 277, in init
    self.playwright_future.set_result(await self._root_object.initialize())
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 219, in initialize
    await self._channel.send(
    ...<4 lines>...
    )
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 61, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python313\Lib\site-packages\playwright\_impl\_connection.py", line 528, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
Exception: Connection.init: Connection closed while reading from the driver
2025-08-28 11:52:47,118 - __main__ - INFO - Prometheus HTTP server started on port 8001
2025-08-28 11:53:34,788 - aiobotocore.credentials - INFO - Found credentials in environment variables.
2025-08-28 11:53:40,145 - __main__ - INFO - Resolved SQS queue URL: https://sqs.us-east-1.amazonaws.com/675076709743/real-estate-scrape-jobs
2025-08-28 11:53:40,254 - __main__ - INFO - SQS consumer started — batch_size=10 concurrency=10 long_poll=5s
2025-08-28 11:53:43,468 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 11:53:43,747 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 11:53:43,841 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 11:53:43,842 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 11:53:44,079 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 11:53:44,079 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 11:53:44,477 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 11:53:44,477 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 11:53:45,159 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 11:53:45,160 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 11:53:46,351 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 11:53:46,351 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 11:53:47,925 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 11:53:47,925 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 11:53:50,390 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 11:53:50,391 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 11:53:56,540 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/212-stuart-boston-ma/fme6gft/
2025-08-28 11:53:56,541 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/212-stuart-boston-ma/fme6gft/
2025-08-28 11:54:05,884 - data_extraction.scraper - INFO - Starting detail scrape for URL: https://www.apartments.com/hub50house-boston-ma/h2x8sm0/
2025-08-28 11:54:05,885 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/hub50house-boston-ma/h2x8sm0/
2025-08-28 11:54:12,130 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/
2025-08-28 11:54:12,704 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/
2025-08-28 11:54:12,971 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/
2025-08-28 11:54:18,377 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 11:54:18,378 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/ with status: Failed: Critical Data Missing
2025-08-28 11:54:19,245 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 11:54:19,245 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/ with status: Failed: Critical Data Missing
2025-08-28 11:54:19,250 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 11:54:19,250 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/ with status: Failed: Critical Data Missing
2025-08-28 11:54:24,064 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/3-morton-pl-boston-ma/st26zs4/ reason=Failed: Critical Data Missing
2025-08-28 11:54:25,040 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1572-commonwealth-ave-boston-ma/bvs3c19/ reason=Failed: Critical Data Missing
2025-08-28 11:54:25,299 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/827-centre-st-boston-ma/rrtdzn3/ reason=Failed: Critical Data Missing
2025-08-28 11:54:45,916 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 11:54:45,931 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 11:54:47,227 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 11:54:49,946 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 11:54:52,454 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 11:54:58,574 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/212-stuart-boston-ma/fme6gft/
2025-08-28 11:55:07,948 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/hub50house-boston-ma/h2x8sm0/
2025-08-28 11:55:46,693 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/hub50house-boston-ma/h2x8sm0/
2025-08-28 11:55:47,931 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 11:55:47,947 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 11:55:49,246 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 11:55:52,160 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 11:55:54,522 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 11:56:00,636 - data_extraction.scraper - INFO - Attempting navigation to: https://www.apartments.com/212-stuart-boston-ma/fme6gft/
2025-08-28 11:56:41,399 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/
2025-08-28 11:56:41,404 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/portside-at-east-pier-east-boston-ma/3sj3kmg/
2025-08-28 11:56:42,236 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/
2025-08-28 11:56:42,481 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 11:56:42,749 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/886-896-huntington-avenue-boston-ma/ehzhz5n/
2025-08-28 11:56:42,754 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 11:56:42,755 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/ with status: Failed: Critical Data Missing
2025-08-28 11:56:43,689 - data_extraction.scraper - INFO - Successfully navigated to: https://www.apartments.com/212-stuart-boston-ma/fme6gft/
2025-08-28 11:56:44,281 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/101-chelsea-st-boston-ma/62qlpws/ reason=Failed: Critical Data Missing
2025-08-28 11:56:45,138 - data_extractor - WARNING - Standard title not found. Skipping detailed extraction.
2025-08-28 11:56:45,139 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/ with status: Failed: Critical Data Missing
2025-08-28 11:56:45,649 - __main__ - WARNING - Validation failed — not deleting. url=https://www.apartments.com/1110-commonwealth-ave-boston-ma-unit-603/xrnb07p/ reason=Failed: Critical Data Missing
2025-08-28 12:00:48,394 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/17-burney-boston-ma/50wr5zn/ with status: Success
2025-08-28 12:00:48,642 - __main__ - INFO - Scrape OK: https://www.apartments.com/17-burney-boston-ma/50wr5zn/ — persisting to DB
2025-08-28 12:00:48,643 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 12:00:58,606 - root - INFO - Inserting new property: 17 Burney
2025-08-28 12:01:00,767 - root - INFO - Successfully processed and committed property: https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 12:01:00,769 - __main__ - INFO - Persisted.
2025-08-28 12:01:03,111 - __main__ - INFO - Deleted message for https://www.apartments.com/17-burney-boston-ma/50wr5zn/
2025-08-28 12:11:56,581 - data_extraction.scraper - INFO - Finished detail scrape for URL: https://www.apartments.com/212-stuart-boston-ma/fme6gft/ with status: Success
2025-08-28 12:11:56,598 - __main__ - INFO - Scrape OK: https://www.apartments.com/212-stuart-boston-ma/fme6gft/ — persisting to DB
2025-08-28 12:11:56,599 - root - INFO - Starting to save 1 properties to the database...
2025-08-28 12:11:57,074 - root - INFO - Inserting new property: 212 Stuart
2025-08-28 12:11:58,040 - root - INFO - Successfully processed and committed property: https://www.apartments.com/212-stuart-boston-ma/fme6gft/
2025-08-28 12:11:58,041 - __main__ - INFO - Persisted.
2025-08-28 12:11:59,035 - __main__ - INFO - Deleted message for https://www.apartments.com/212-stuart-boston-ma/fme6gft/
